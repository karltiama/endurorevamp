307d75602c731e5648f58a900f66d246
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "TrainingZoneAnalysis", {
    enumerable: true,
    get: function() {
        return TrainingZoneAnalysis;
    }
});
const _server = require("../supabase/server");
class TrainingZoneAnalysis {
    constructor(){
        this.supabase = (0, _server.createClient)();
    }
    /**
   * Main analysis function - analyzes user's activities and suggests training zones
   */ async analyzeUserZones(userId) {
        console.log(`🔍 Starting zone analysis for user: ${userId}`);
        try {
            // 1. Get heart rate statistics from activities
            const hrStats = await this.getHeartRateStatistics(userId);
            console.log(`📊 HR Stats:`, hrStats);
            // 2. Get sport-specific analysis
            const sportAnalysis = await this.getSportSpecificAnalysis(userId);
            console.log(`🏃‍♂️ Sport analysis:`, sportAnalysis);
            // 3. Generate zone recommendations
            const recommendations = this.generateRecommendations(hrStats, sportAnalysis);
            // 4. Create zone models
            const zoneModels = this.createZoneModels(hrStats.maxHeartRate);
            // 5. Select best zone model
            const suggestedModel = this.selectBestZoneModel(zoneModels);
            // 6. Determine confidence level
            const confidence = this.calculateConfidence(hrStats);
            return {
                overall: hrStats,
                sportSpecific: sportAnalysis,
                suggestedZoneModel: suggestedModel,
                alternativeModels: zoneModels.filter((m)=>m.name !== suggestedModel.name),
                recommendations,
                confidence,
                needsMoreData: hrStats.hrDataQuality === 'poor' || hrStats.hrDataQuality === 'none'
            };
        } catch (error) {
            console.error('❌ Zone analysis failed:', error);
            throw error;
        }
    }
    /**
   * Analyze heart rate data from user's activities
   */ async getHeartRateStatistics(userId) {
        const supabase = await this.supabase;
        // Get all activities with heart rate data
        const { data: activities, error } = await supabase.from('activities').select('average_heartrate, max_heartrate, has_heartrate, sport_type').eq('user_id', userId).order('start_date_local', {
            ascending: false
        });
        if (error) {
            throw error;
        }
        if (!activities || activities.length === 0) {
            return this.getEmptyHeartRateStats();
        }
        // Filter activities with heart rate data
        const hrActivities = activities.filter((a)=>a.has_heartrate && a.average_heartrate);
        const totalActivities = activities.length;
        const activitiesWithHR = hrActivities.length;
        if (hrActivities.length === 0) {
            return {
                ...this.getEmptyHeartRateStats(),
                totalActivities,
                activitiesWithHR: 0
            };
        }
        // Calculate statistics
        const maxHeartRate = Math.max(...hrActivities.map((a)=>a.max_heartrate || a.average_heartrate));
        const avgHeartRates = hrActivities.map((a)=>a.average_heartrate).filter((hr)=>hr > 0);
        const averageHeartRate = avgHeartRates.reduce((sum, hr)=>sum + hr, 0) / avgHeartRates.length;
        // Estimate resting HR (lowest 5th percentile of average HRs)
        const sortedAvgHR = avgHeartRates.sort((a, b)=>a - b);
        const restingHeartRate = sortedAvgHR[Math.floor(sortedAvgHR.length * 0.05)] || null;
        // Calculate percentiles of max heart rates
        const maxHRs = hrActivities.map((a)=>a.max_heartrate || a.average_heartrate).sort((a, b)=>a - b);
        const percentiles = {
            p50: this.getPercentile(maxHRs, 50),
            p75: this.getPercentile(maxHRs, 75),
            p85: this.getPercentile(maxHRs, 85),
            p90: this.getPercentile(maxHRs, 90),
            p95: this.getPercentile(maxHRs, 95),
            p99: this.getPercentile(maxHRs, 99)
        };
        // Determine data quality
        const hrDataQuality = this.assessDataQuality(activitiesWithHR, totalActivities);
        return {
            maxHeartRate,
            averageHeartRate: Math.round(averageHeartRate),
            restingHeartRate: restingHeartRate ? Math.round(restingHeartRate) : null,
            activitiesWithHR,
            totalActivities,
            hrDataQuality,
            percentiles
        };
    }
    /**
   * Analyze heart rate patterns by sport type
   */ async getSportSpecificAnalysis(userId) {
        const supabase = await this.supabase;
        const { data: sportData, error } = await supabase.from('activities').select('sport_type, average_heartrate, max_heartrate, has_heartrate').eq('user_id', userId).eq('has_heartrate', true).not('average_heartrate', 'is', null);
        if (error || !sportData) {
            return [];
        }
        // Group by sport type
        const sportGroups = sportData.reduce((groups, activity)=>{
            const sport = this.normalizeSportType(activity.sport_type);
            if (!groups[sport]) groups[sport] = [];
            groups[sport].push(activity);
            return groups;
        }, {});
        // Analyze each sport
        return Object.entries(sportGroups).filter(([, activities])=>activities.length >= 3) // Minimum 3 activities for analysis
        .map(([sport, activities])=>{
            const heartRates = activities.map((a)=>a.max_heartrate || a.average_heartrate).filter((hr)=>hr !== undefined && hr > 0);
            const maxHR = heartRates.length > 0 ? Math.max(...heartRates) : 0;
            const avgHRs = activities.map((a)=>a.average_heartrate).filter((hr)=>hr !== undefined && hr > 0);
            const avgHR = avgHRs.length > 0 ? Math.round(avgHRs.reduce((sum, hr)=>sum + hr, 0) / avgHRs.length) : 0;
            return {
                sport,
                maxHR,
                avgHR,
                activityCount: activities.length,
                suggestedZones: this.createZoneModels(maxHR)[0].zones // Use 5-zone model
            };
        }).sort((a, b)=>b.activityCount - a.activityCount) // Sort by activity count
        ;
    }
    /**
   * Create different zone models based on max heart rate
   */ createZoneModels(maxHR) {
        if (!maxHR || maxHR < 120) {
            // Use age-based estimation if no valid max HR
            const estimatedMaxHR = 220 - 30 // Assume 30 years old as default
            ;
            maxHR = estimatedMaxHR;
        }
        return [
            this.createFiveZoneModel(maxHR),
            this.createThreeZoneModel(maxHR),
            this.createCoganModel(maxHR)
        ];
    }
    /**
   * 5-Zone Heart Rate Model (Most common)
   */ createFiveZoneModel(maxHR) {
        const zones = [
            {
                number: 1,
                name: 'Recovery',
                description: 'Active recovery, very easy effort',
                minPercent: 50,
                maxPercent: 60,
                minHR: Math.round(maxHR * 0.50),
                maxHR: Math.round(maxHR * 0.60),
                color: '#22c55e' // green
            },
            {
                number: 2,
                name: 'Base/Aerobic',
                description: 'Comfortable, conversational pace',
                minPercent: 60,
                maxPercent: 70,
                minHR: Math.round(maxHR * 0.60),
                maxHR: Math.round(maxHR * 0.70),
                color: '#3b82f6' // blue
            },
            {
                number: 3,
                name: 'Tempo',
                description: 'Comfortably hard, moderate effort',
                minPercent: 70,
                maxPercent: 80,
                minHR: Math.round(maxHR * 0.70),
                maxHR: Math.round(maxHR * 0.80),
                color: '#f59e0b' // yellow
            },
            {
                number: 4,
                name: 'Threshold',
                description: 'Hard effort, lactate threshold',
                minPercent: 80,
                maxPercent: 90,
                minHR: Math.round(maxHR * 0.80),
                maxHR: Math.round(maxHR * 0.90),
                color: '#f97316' // orange
            },
            {
                number: 5,
                name: 'VO2 Max',
                description: 'Very hard, maximum effort',
                minPercent: 90,
                maxPercent: 100,
                minHR: Math.round(maxHR * 0.90),
                maxHR: maxHR,
                color: '#ef4444' // red
            }
        ];
        return {
            name: '5-Zone Model',
            description: 'Classic 5-zone heart rate training model',
            zones
        };
    }
    /**
   * 3-Zone Simplified Model
   */ createThreeZoneModel(maxHR) {
        const zones = [
            {
                number: 1,
                name: 'Easy',
                description: 'Easy, aerobic base building',
                minPercent: 50,
                maxPercent: 70,
                minHR: Math.round(maxHR * 0.50),
                maxHR: Math.round(maxHR * 0.70),
                color: '#22c55e'
            },
            {
                number: 2,
                name: 'Moderate',
                description: 'Moderate, tempo efforts',
                minPercent: 70,
                maxPercent: 85,
                minHR: Math.round(maxHR * 0.70),
                maxHR: Math.round(maxHR * 0.85),
                color: '#f59e0b'
            },
            {
                number: 3,
                name: 'Hard',
                description: 'Hard, threshold and VO2 max',
                minPercent: 85,
                maxPercent: 100,
                minHR: Math.round(maxHR * 0.85),
                maxHR: maxHR,
                color: '#ef4444'
            }
        ];
        return {
            name: '3-Zone Model',
            description: 'Simplified 3-zone model for beginners',
            zones
        };
    }
    /**
   * Coggan Power-Based Zones Adapted for HR
   */ createCoganModel(maxHR) {
        const zones = [
            {
                number: 1,
                name: 'Active Recovery',
                description: 'Active recovery, < 68% max HR',
                minPercent: 50,
                maxPercent: 68,
                minHR: Math.round(maxHR * 0.50),
                maxHR: Math.round(maxHR * 0.68),
                color: '#22c55e'
            },
            {
                number: 2,
                name: 'Endurance',
                description: 'Endurance, 69-83% max HR',
                minPercent: 69,
                maxPercent: 83,
                minHR: Math.round(maxHR * 0.69),
                maxHR: Math.round(maxHR * 0.83),
                color: '#3b82f6'
            },
            {
                number: 3,
                name: 'Tempo',
                description: 'Tempo, 84-94% max HR',
                minPercent: 84,
                maxPercent: 94,
                minHR: Math.round(maxHR * 0.84),
                maxHR: Math.round(maxHR * 0.94),
                color: '#f59e0b'
            },
            {
                number: 4,
                name: 'Threshold',
                description: 'Lactate threshold, 95-105% max HR',
                minPercent: 95,
                maxPercent: 105,
                minHR: Math.round(maxHR * 0.95),
                maxHR: Math.min(Math.round(maxHR * 1.05), maxHR),
                color: '#f97316'
            },
            {
                number: 5,
                name: 'VO2 Max',
                description: 'VO2 max, 106%+ max HR',
                minPercent: 106,
                maxPercent: 120,
                minHR: Math.round(maxHR * 1.06),
                maxHR: Math.round(maxHR * 1.20),
                color: '#ef4444'
            }
        ];
        return {
            name: 'Coggan Model',
            description: 'Coggan-style zones adapted for heart rate',
            zones
        };
    }
    /**
   * Helper functions
   */ getEmptyHeartRateStats() {
        return {
            maxHeartRate: null,
            averageHeartRate: null,
            restingHeartRate: null,
            activitiesWithHR: 0,
            totalActivities: 0,
            hrDataQuality: 'none',
            percentiles: {
                p50: null,
                p75: null,
                p85: null,
                p90: null,
                p95: null,
                p99: null
            }
        };
    }
    getPercentile(sortedArray, percentile) {
        if (sortedArray.length === 0) return null;
        // Use linear interpolation method (R-6/Excel method)
        const n = sortedArray.length;
        const rank = percentile / 100 * (n + 1);
        if (rank <= 1) return sortedArray[0];
        if (rank >= n) return sortedArray[n - 1];
        const lowerIndex = Math.floor(rank) - 1;
        const upperIndex = Math.ceil(rank) - 1;
        const weight = rank - Math.floor(rank);
        return sortedArray[lowerIndex] + weight * (sortedArray[upperIndex] - sortedArray[lowerIndex]);
    }
    assessDataQuality(hrActivities, totalActivities) {
        const hrPercentage = totalActivities > 0 ? hrActivities / totalActivities * 100 : 0;
        if (hrPercentage === 0) return 'none';
        if (hrPercentage < 20 || hrActivities < 5) return 'poor';
        if (hrPercentage < 50 || hrActivities < 10) return 'fair';
        if (hrPercentage < 80 || hrActivities < 20) return 'good';
        return 'excellent';
    }
    normalizeSportType(sportType) {
        const sport = sportType.toLowerCase();
        if (sport.includes('run')) return 'Running';
        if (sport.includes('ride') || sport.includes('bike') || sport.includes('cycling')) return 'Cycling';
        if (sport.includes('swim')) return 'Swimming';
        if (sport.includes('walk') || sport.includes('hike')) return 'Walking';
        return sportType;
    }
    selectBestZoneModel(models) {
        // For now, default to 5-zone model
        // Could be more intelligent based on user data in the future
        return models.find((m)=>m.name === '5-Zone Model') || models[0];
    }
    calculateConfidence(stats) {
        if (stats.hrDataQuality === 'excellent' && stats.activitiesWithHR >= 20) return 'high';
        if (stats.hrDataQuality === 'good' && stats.activitiesWithHR >= 10) return 'medium';
        return 'low';
    }
    generateRecommendations(stats, sportAnalysis) {
        const recommendations = [];
        if (stats.hrDataQuality === 'poor' || stats.hrDataQuality === 'none') {
            recommendations.push('Consider using a heart rate monitor for more activities to improve zone accuracy');
        }
        if (stats.activitiesWithHR < 10) {
            recommendations.push('More heart rate data will improve zone recommendations');
        }
        if (sportAnalysis.length > 1) {
            recommendations.push('Consider sport-specific zones as your heart rate patterns vary between activities');
        }
        if (stats.maxHeartRate && stats.maxHeartRate < 160) {
            recommendations.push('Your max heart rate seems low - consider a max HR test for better accuracy');
        }
        return recommendations;
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGlhbWFcXERlc2t0b3BcXENvZGluZ1xcZW5kdXJvcmV2YW1wXFxsaWJcXHRyYWluaW5nXFx6b25lLWFuYWx5c2lzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcidcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSGVhcnRSYXRlU3RhdHMge1xyXG4gIG1heEhlYXJ0UmF0ZTogbnVtYmVyIHwgbnVsbFxyXG4gIGF2ZXJhZ2VIZWFydFJhdGU6IG51bWJlciB8IG51bGxcclxuICByZXN0aW5nSGVhcnRSYXRlOiBudW1iZXIgfCBudWxsIC8vIENhbiBiZSBlc3RpbWF0ZWQgZnJvbSBsb3dlc3QgcmVjb3JkZWRcclxuICBhY3Rpdml0aWVzV2l0aEhSOiBudW1iZXJcclxuICB0b3RhbEFjdGl2aXRpZXM6IG51bWJlclxyXG4gIGhyRGF0YVF1YWxpdHk6ICdleGNlbGxlbnQnIHwgJ2dvb2QnIHwgJ2ZhaXInIHwgJ3Bvb3InIHwgJ25vbmUnXHJcbiAgcGVyY2VudGlsZXM6IHtcclxuICAgIHA1MDogbnVtYmVyIHwgbnVsbCAvLyBNZWRpYW5cclxuICAgIHA3NTogbnVtYmVyIHwgbnVsbFxyXG4gICAgcDg1OiBudW1iZXIgfCBudWxsXHJcbiAgICBwOTA6IG51bWJlciB8IG51bGxcclxuICAgIHA5NTogbnVtYmVyIHwgbnVsbFxyXG4gICAgcDk5OiBudW1iZXIgfCBudWxsXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRyYWluaW5nWm9uZSB7XHJcbiAgbnVtYmVyOiBudW1iZXJcclxuICBuYW1lOiBzdHJpbmdcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nXHJcbiAgbWluSFI6IG51bWJlclxyXG4gIG1heEhSOiBudW1iZXJcclxuICBtaW5QZXJjZW50OiBudW1iZXJcclxuICBtYXhQZXJjZW50OiBudW1iZXJcclxuICBjb2xvcjogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgWm9uZU1vZGVsIHtcclxuICBuYW1lOiBzdHJpbmdcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nXHJcbiAgem9uZXM6IFRyYWluaW5nWm9uZVtdXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3BvcnRTcGVjaWZpY0FuYWx5c2lzIHtcclxuICBzcG9ydDogc3RyaW5nXHJcbiAgbWF4SFI6IG51bWJlciB8IG51bGxcclxuICBhdmdIUjogbnVtYmVyIHwgbnVsbFxyXG4gIGFjdGl2aXR5Q291bnQ6IG51bWJlclxyXG4gIHN1Z2dlc3RlZFpvbmVzOiBUcmFpbmluZ1pvbmVbXVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFpvbmVBbmFseXNpc1Jlc3VsdCB7XHJcbiAgb3ZlcmFsbDogSGVhcnRSYXRlU3RhdHNcclxuICBzcG9ydFNwZWNpZmljOiBTcG9ydFNwZWNpZmljQW5hbHlzaXNbXVxyXG4gIHN1Z2dlc3RlZFpvbmVNb2RlbDogWm9uZU1vZGVsXHJcbiAgYWx0ZXJuYXRpdmVNb2RlbHM6IFpvbmVNb2RlbFtdXHJcbiAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXVxyXG4gIGNvbmZpZGVuY2U6ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdydcclxuICBuZWVkc01vcmVEYXRhOiBib29sZWFuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUcmFpbmluZ1pvbmVBbmFseXNpcyB7XHJcbiAgcHJpdmF0ZSBzdXBhYmFzZVxyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFpbiBhbmFseXNpcyBmdW5jdGlvbiAtIGFuYWx5emVzIHVzZXIncyBhY3Rpdml0aWVzIGFuZCBzdWdnZXN0cyB0cmFpbmluZyB6b25lc1xyXG4gICAqL1xyXG4gIGFzeW5jIGFuYWx5emVVc2VyWm9uZXModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFpvbmVBbmFseXNpc1Jlc3VsdD4ge1xyXG4gICAgY29uc29sZS5sb2coYPCflI0gU3RhcnRpbmcgem9uZSBhbmFseXNpcyBmb3IgdXNlcjogJHt1c2VySWR9YClcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyAxLiBHZXQgaGVhcnQgcmF0ZSBzdGF0aXN0aWNzIGZyb20gYWN0aXZpdGllc1xyXG4gICAgICBjb25zdCBoclN0YXRzID0gYXdhaXQgdGhpcy5nZXRIZWFydFJhdGVTdGF0aXN0aWNzKHVzZXJJZClcclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogSFIgU3RhdHM6YCwgaHJTdGF0cylcclxuXHJcbiAgICAgIC8vIDIuIEdldCBzcG9ydC1zcGVjaWZpYyBhbmFseXNpc1xyXG4gICAgICBjb25zdCBzcG9ydEFuYWx5c2lzID0gYXdhaXQgdGhpcy5nZXRTcG9ydFNwZWNpZmljQW5hbHlzaXModXNlcklkKVxyXG4gICAgICBjb25zb2xlLmxvZyhg8J+Pg+KAjeKZgu+4jyBTcG9ydCBhbmFseXNpczpgLCBzcG9ydEFuYWx5c2lzKVxyXG5cclxuICAgICAgLy8gMy4gR2VuZXJhdGUgem9uZSByZWNvbW1lbmRhdGlvbnNcclxuICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhoclN0YXRzLCBzcG9ydEFuYWx5c2lzKVxyXG4gICAgICBcclxuICAgICAgLy8gNC4gQ3JlYXRlIHpvbmUgbW9kZWxzXHJcbiAgICAgIGNvbnN0IHpvbmVNb2RlbHMgPSB0aGlzLmNyZWF0ZVpvbmVNb2RlbHMoaHJTdGF0cy5tYXhIZWFydFJhdGUpXHJcbiAgICAgIFxyXG4gICAgICAvLyA1LiBTZWxlY3QgYmVzdCB6b25lIG1vZGVsXHJcbiAgICAgIGNvbnN0IHN1Z2dlc3RlZE1vZGVsID0gdGhpcy5zZWxlY3RCZXN0Wm9uZU1vZGVsKHpvbmVNb2RlbHMpXHJcblxyXG4gICAgICAvLyA2LiBEZXRlcm1pbmUgY29uZmlkZW5jZSBsZXZlbFxyXG4gICAgICBjb25zdCBjb25maWRlbmNlID0gdGhpcy5jYWxjdWxhdGVDb25maWRlbmNlKGhyU3RhdHMpXHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIG92ZXJhbGw6IGhyU3RhdHMsXHJcbiAgICAgICAgc3BvcnRTcGVjaWZpYzogc3BvcnRBbmFseXNpcyxcclxuICAgICAgICBzdWdnZXN0ZWRab25lTW9kZWw6IHN1Z2dlc3RlZE1vZGVsLFxyXG4gICAgICAgIGFsdGVybmF0aXZlTW9kZWxzOiB6b25lTW9kZWxzLmZpbHRlcihtID0+IG0ubmFtZSAhPT0gc3VnZ2VzdGVkTW9kZWwubmFtZSksXHJcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLFxyXG4gICAgICAgIGNvbmZpZGVuY2UsXHJcbiAgICAgICAgbmVlZHNNb3JlRGF0YTogaHJTdGF0cy5ockRhdGFRdWFsaXR5ID09PSAncG9vcicgfHwgaHJTdGF0cy5ockRhdGFRdWFsaXR5ID09PSAnbm9uZSdcclxuICAgICAgfVxyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBab25lIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcclxuICAgICAgdGhyb3cgZXJyb3JcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFuYWx5emUgaGVhcnQgcmF0ZSBkYXRhIGZyb20gdXNlcidzIGFjdGl2aXRpZXNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGdldEhlYXJ0UmF0ZVN0YXRpc3RpY3ModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPEhlYXJ0UmF0ZVN0YXRzPiB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuXHJcbiAgICAvLyBHZXQgYWxsIGFjdGl2aXRpZXMgd2l0aCBoZWFydCByYXRlIGRhdGFcclxuICAgIGNvbnN0IHsgZGF0YTogYWN0aXZpdGllcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdhY3Rpdml0aWVzJylcclxuICAgICAgLnNlbGVjdCgnYXZlcmFnZV9oZWFydHJhdGUsIG1heF9oZWFydHJhdGUsIGhhc19oZWFydHJhdGUsIHNwb3J0X3R5cGUnKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXHJcbiAgICAgIC5vcmRlcignc3RhcnRfZGF0ZV9sb2NhbCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICB0aHJvdyBlcnJvclxyXG4gICAgfVxyXG5cclxuICAgIGlmICghYWN0aXZpdGllcyB8fCBhY3Rpdml0aWVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5nZXRFbXB0eUhlYXJ0UmF0ZVN0YXRzKClcclxuICAgIH1cclxuXHJcbiAgICAvLyBGaWx0ZXIgYWN0aXZpdGllcyB3aXRoIGhlYXJ0IHJhdGUgZGF0YVxyXG4gICAgY29uc3QgaHJBY3Rpdml0aWVzID0gYWN0aXZpdGllcy5maWx0ZXIoYSA9PiBhLmhhc19oZWFydHJhdGUgJiYgYS5hdmVyYWdlX2hlYXJ0cmF0ZSlcclxuICAgIGNvbnN0IHRvdGFsQWN0aXZpdGllcyA9IGFjdGl2aXRpZXMubGVuZ3RoXHJcbiAgICBjb25zdCBhY3Rpdml0aWVzV2l0aEhSID0gaHJBY3Rpdml0aWVzLmxlbmd0aFxyXG5cclxuICAgIGlmIChockFjdGl2aXRpZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgLi4udGhpcy5nZXRFbXB0eUhlYXJ0UmF0ZVN0YXRzKCksXHJcbiAgICAgICAgdG90YWxBY3Rpdml0aWVzLFxyXG4gICAgICAgIGFjdGl2aXRpZXNXaXRoSFI6IDBcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBzdGF0aXN0aWNzXHJcbiAgICBjb25zdCBtYXhIZWFydFJhdGUgPSBNYXRoLm1heCguLi5ockFjdGl2aXRpZXMubWFwKGEgPT4gYS5tYXhfaGVhcnRyYXRlIHx8IGEuYXZlcmFnZV9oZWFydHJhdGUpKVxyXG4gICAgY29uc3QgYXZnSGVhcnRSYXRlcyA9IGhyQWN0aXZpdGllcy5tYXAoYSA9PiBhLmF2ZXJhZ2VfaGVhcnRyYXRlKS5maWx0ZXIoaHIgPT4gaHIgPiAwKVxyXG4gICAgY29uc3QgYXZlcmFnZUhlYXJ0UmF0ZSA9IGF2Z0hlYXJ0UmF0ZXMucmVkdWNlKChzdW0sIGhyKSA9PiBzdW0gKyBociwgMCkgLyBhdmdIZWFydFJhdGVzLmxlbmd0aFxyXG5cclxuICAgIC8vIEVzdGltYXRlIHJlc3RpbmcgSFIgKGxvd2VzdCA1dGggcGVyY2VudGlsZSBvZiBhdmVyYWdlIEhScylcclxuICAgIGNvbnN0IHNvcnRlZEF2Z0hSID0gYXZnSGVhcnRSYXRlcy5zb3J0KChhLCBiKSA9PiBhIC0gYilcclxuICAgIGNvbnN0IHJlc3RpbmdIZWFydFJhdGUgPSBzb3J0ZWRBdmdIUltNYXRoLmZsb29yKHNvcnRlZEF2Z0hSLmxlbmd0aCAqIDAuMDUpXSB8fCBudWxsXHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHBlcmNlbnRpbGVzIG9mIG1heCBoZWFydCByYXRlc1xyXG4gICAgY29uc3QgbWF4SFJzID0gaHJBY3Rpdml0aWVzLm1hcChhID0+IGEubWF4X2hlYXJ0cmF0ZSB8fCBhLmF2ZXJhZ2VfaGVhcnRyYXRlKS5zb3J0KChhLCBiKSA9PiBhIC0gYilcclxuICAgIGNvbnN0IHBlcmNlbnRpbGVzID0ge1xyXG4gICAgICBwNTA6IHRoaXMuZ2V0UGVyY2VudGlsZShtYXhIUnMsIDUwKSxcclxuICAgICAgcDc1OiB0aGlzLmdldFBlcmNlbnRpbGUobWF4SFJzLCA3NSksXHJcbiAgICAgIHA4NTogdGhpcy5nZXRQZXJjZW50aWxlKG1heEhScywgODUpLFxyXG4gICAgICBwOTA6IHRoaXMuZ2V0UGVyY2VudGlsZShtYXhIUnMsIDkwKSxcclxuICAgICAgcDk1OiB0aGlzLmdldFBlcmNlbnRpbGUobWF4SFJzLCA5NSksXHJcbiAgICAgIHA5OTogdGhpcy5nZXRQZXJjZW50aWxlKG1heEhScywgOTkpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIGRhdGEgcXVhbGl0eVxyXG4gICAgY29uc3QgaHJEYXRhUXVhbGl0eSA9IHRoaXMuYXNzZXNzRGF0YVF1YWxpdHkoYWN0aXZpdGllc1dpdGhIUiwgdG90YWxBY3Rpdml0aWVzKVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG1heEhlYXJ0UmF0ZSxcclxuICAgICAgYXZlcmFnZUhlYXJ0UmF0ZTogTWF0aC5yb3VuZChhdmVyYWdlSGVhcnRSYXRlKSxcclxuICAgICAgcmVzdGluZ0hlYXJ0UmF0ZTogcmVzdGluZ0hlYXJ0UmF0ZSA/IE1hdGgucm91bmQocmVzdGluZ0hlYXJ0UmF0ZSkgOiBudWxsLFxyXG4gICAgICBhY3Rpdml0aWVzV2l0aEhSLFxyXG4gICAgICB0b3RhbEFjdGl2aXRpZXMsXHJcbiAgICAgIGhyRGF0YVF1YWxpdHksXHJcbiAgICAgIHBlcmNlbnRpbGVzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbmFseXplIGhlYXJ0IHJhdGUgcGF0dGVybnMgYnkgc3BvcnQgdHlwZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZ2V0U3BvcnRTcGVjaWZpY0FuYWx5c2lzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxTcG9ydFNwZWNpZmljQW5hbHlzaXNbXT4ge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiBzcG9ydERhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYWN0aXZpdGllcycpXHJcbiAgICAgIC5zZWxlY3QoJ3Nwb3J0X3R5cGUsIGF2ZXJhZ2VfaGVhcnRyYXRlLCBtYXhfaGVhcnRyYXRlLCBoYXNfaGVhcnRyYXRlJylcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG4gICAgICAuZXEoJ2hhc19oZWFydHJhdGUnLCB0cnVlKVxyXG4gICAgICAubm90KCdhdmVyYWdlX2hlYXJ0cmF0ZScsICdpcycsIG51bGwpXHJcblxyXG4gICAgaWYgKGVycm9yIHx8ICFzcG9ydERhdGEpIHtcclxuICAgICAgcmV0dXJuIFtdXHJcbiAgICB9XHJcblxyXG4gICAgLy8gR3JvdXAgYnkgc3BvcnQgdHlwZVxyXG4gICAgY29uc3Qgc3BvcnRHcm91cHMgPSBzcG9ydERhdGEucmVkdWNlKChncm91cHMsIGFjdGl2aXR5KSA9PiB7XHJcbiAgICAgIGNvbnN0IHNwb3J0ID0gdGhpcy5ub3JtYWxpemVTcG9ydFR5cGUoYWN0aXZpdHkuc3BvcnRfdHlwZSlcclxuICAgICAgaWYgKCFncm91cHNbc3BvcnRdKSBncm91cHNbc3BvcnRdID0gW11cclxuICAgICAgZ3JvdXBzW3Nwb3J0XS5wdXNoKGFjdGl2aXR5KVxyXG4gICAgICByZXR1cm4gZ3JvdXBzXHJcbiAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBBcnJheTx7IHNwb3J0X3R5cGU6IHN0cmluZzsgbWF4X2hlYXJ0cmF0ZT86IG51bWJlcjsgYXZlcmFnZV9oZWFydHJhdGU/OiBudW1iZXIgfT4+KVxyXG5cclxuICAgIC8vIEFuYWx5emUgZWFjaCBzcG9ydFxyXG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHNwb3J0R3JvdXBzKVxyXG4gICAgICAuZmlsdGVyKChbLCBhY3Rpdml0aWVzXSkgPT4gYWN0aXZpdGllcy5sZW5ndGggPj0gMykgLy8gTWluaW11bSAzIGFjdGl2aXRpZXMgZm9yIGFuYWx5c2lzXHJcbiAgICAgIC5tYXAoKFtzcG9ydCwgYWN0aXZpdGllc10pID0+IHtcclxuICAgICAgICBjb25zdCBoZWFydFJhdGVzID0gYWN0aXZpdGllc1xyXG4gICAgICAgICAgLm1hcChhID0+IGEubWF4X2hlYXJ0cmF0ZSB8fCBhLmF2ZXJhZ2VfaGVhcnRyYXRlKVxyXG4gICAgICAgICAgLmZpbHRlcigoaHIpOiBociBpcyBudW1iZXIgPT4gaHIgIT09IHVuZGVmaW5lZCAmJiBociA+IDApXHJcbiAgICAgICAgY29uc3QgbWF4SFIgPSBoZWFydFJhdGVzLmxlbmd0aCA+IDAgPyBNYXRoLm1heCguLi5oZWFydFJhdGVzKSA6IDBcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBhdmdIUnMgPSBhY3Rpdml0aWVzXHJcbiAgICAgICAgICAubWFwKGEgPT4gYS5hdmVyYWdlX2hlYXJ0cmF0ZSlcclxuICAgICAgICAgIC5maWx0ZXIoKGhyKTogaHIgaXMgbnVtYmVyID0+IGhyICE9PSB1bmRlZmluZWQgJiYgaHIgPiAwKVxyXG4gICAgICAgIGNvbnN0IGF2Z0hSID0gYXZnSFJzLmxlbmd0aCA+IDAgPyBNYXRoLnJvdW5kKGF2Z0hScy5yZWR1Y2UoKHN1bSwgaHIpID0+IHN1bSArIGhyLCAwKSAvIGF2Z0hScy5sZW5ndGgpIDogMFxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzcG9ydCxcclxuICAgICAgICAgIG1heEhSLFxyXG4gICAgICAgICAgYXZnSFIsXHJcbiAgICAgICAgICBhY3Rpdml0eUNvdW50OiBhY3Rpdml0aWVzLmxlbmd0aCxcclxuICAgICAgICAgIHN1Z2dlc3RlZFpvbmVzOiB0aGlzLmNyZWF0ZVpvbmVNb2RlbHMobWF4SFIpWzBdLnpvbmVzIC8vIFVzZSA1LXpvbmUgbW9kZWxcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmFjdGl2aXR5Q291bnQgLSBhLmFjdGl2aXR5Q291bnQpIC8vIFNvcnQgYnkgYWN0aXZpdHkgY291bnRcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBkaWZmZXJlbnQgem9uZSBtb2RlbHMgYmFzZWQgb24gbWF4IGhlYXJ0IHJhdGVcclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlWm9uZU1vZGVscyhtYXhIUjogbnVtYmVyIHwgbnVsbCk6IFpvbmVNb2RlbFtdIHtcclxuICAgIGlmICghbWF4SFIgfHwgbWF4SFIgPCAxMjApIHtcclxuICAgICAgLy8gVXNlIGFnZS1iYXNlZCBlc3RpbWF0aW9uIGlmIG5vIHZhbGlkIG1heCBIUlxyXG4gICAgICBjb25zdCBlc3RpbWF0ZWRNYXhIUiA9IDIyMCAtIDMwIC8vIEFzc3VtZSAzMCB5ZWFycyBvbGQgYXMgZGVmYXVsdFxyXG4gICAgICBtYXhIUiA9IGVzdGltYXRlZE1heEhSXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFtcclxuICAgICAgdGhpcy5jcmVhdGVGaXZlWm9uZU1vZGVsKG1heEhSKSxcclxuICAgICAgdGhpcy5jcmVhdGVUaHJlZVpvbmVNb2RlbChtYXhIUiksXHJcbiAgICAgIHRoaXMuY3JlYXRlQ29nYW5Nb2RlbChtYXhIUilcclxuICAgIF1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIDUtWm9uZSBIZWFydCBSYXRlIE1vZGVsIChNb3N0IGNvbW1vbilcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZUZpdmVab25lTW9kZWwobWF4SFI6IG51bWJlcik6IFpvbmVNb2RlbCB7XHJcbiAgICBjb25zdCB6b25lczogVHJhaW5pbmdab25lW10gPSBbXHJcbiAgICAgIHtcclxuICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgbmFtZTogJ1JlY292ZXJ5JyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FjdGl2ZSByZWNvdmVyeSwgdmVyeSBlYXN5IGVmZm9ydCcsXHJcbiAgICAgICAgbWluUGVyY2VudDogNTAsXHJcbiAgICAgICAgbWF4UGVyY2VudDogNjAsXHJcbiAgICAgICAgbWluSFI6IE1hdGgucm91bmQobWF4SFIgKiAwLjUwKSxcclxuICAgICAgICBtYXhIUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuNjApLFxyXG4gICAgICAgIGNvbG9yOiAnIzIyYzU1ZScgLy8gZ3JlZW5cclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIG51bWJlcjogMixcclxuICAgICAgICBuYW1lOiAnQmFzZS9BZXJvYmljJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbWZvcnRhYmxlLCBjb252ZXJzYXRpb25hbCBwYWNlJyxcclxuICAgICAgICBtaW5QZXJjZW50OiA2MCxcclxuICAgICAgICBtYXhQZXJjZW50OiA3MCxcclxuICAgICAgICBtaW5IUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuNjApLFxyXG4gICAgICAgIG1heEhSOiBNYXRoLnJvdW5kKG1heEhSICogMC43MCksXHJcbiAgICAgICAgY29sb3I6ICcjM2I4MmY2JyAvLyBibHVlXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBudW1iZXI6IDMsXHJcbiAgICAgICAgbmFtZTogJ1RlbXBvJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbWZvcnRhYmx5IGhhcmQsIG1vZGVyYXRlIGVmZm9ydCcsXHJcbiAgICAgICAgbWluUGVyY2VudDogNzAsXHJcbiAgICAgICAgbWF4UGVyY2VudDogODAsXHJcbiAgICAgICAgbWluSFI6IE1hdGgucm91bmQobWF4SFIgKiAwLjcwKSxcclxuICAgICAgICBtYXhIUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuODApLFxyXG4gICAgICAgIGNvbG9yOiAnI2Y1OWUwYicgLy8geWVsbG93XHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBudW1iZXI6IDQsXHJcbiAgICAgICAgbmFtZTogJ1RocmVzaG9sZCcsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdIYXJkIGVmZm9ydCwgbGFjdGF0ZSB0aHJlc2hvbGQnLFxyXG4gICAgICAgIG1pblBlcmNlbnQ6IDgwLFxyXG4gICAgICAgIG1heFBlcmNlbnQ6IDkwLFxyXG4gICAgICAgIG1pbkhSOiBNYXRoLnJvdW5kKG1heEhSICogMC44MCksXHJcbiAgICAgICAgbWF4SFI6IE1hdGgucm91bmQobWF4SFIgKiAwLjkwKSxcclxuICAgICAgICBjb2xvcjogJyNmOTczMTYnIC8vIG9yYW5nZVxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgbnVtYmVyOiA1LFxyXG4gICAgICAgIG5hbWU6ICdWTzIgTWF4JyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1ZlcnkgaGFyZCwgbWF4aW11bSBlZmZvcnQnLFxyXG4gICAgICAgIG1pblBlcmNlbnQ6IDkwLFxyXG4gICAgICAgIG1heFBlcmNlbnQ6IDEwMCxcclxuICAgICAgICBtaW5IUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuOTApLFxyXG4gICAgICAgIG1heEhSOiBtYXhIUixcclxuICAgICAgICBjb2xvcjogJyNlZjQ0NDQnIC8vIHJlZFxyXG4gICAgICB9XHJcbiAgICBdXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogJzUtWm9uZSBNb2RlbCcsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiAnQ2xhc3NpYyA1LXpvbmUgaGVhcnQgcmF0ZSB0cmFpbmluZyBtb2RlbCcsXHJcbiAgICAgIHpvbmVzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiAzLVpvbmUgU2ltcGxpZmllZCBNb2RlbFxyXG4gICAqL1xyXG4gIHByaXZhdGUgY3JlYXRlVGhyZWVab25lTW9kZWwobWF4SFI6IG51bWJlcik6IFpvbmVNb2RlbCB7XHJcbiAgICBjb25zdCB6b25lczogVHJhaW5pbmdab25lW10gPSBbXHJcbiAgICAgIHtcclxuICAgICAgICBudW1iZXI6IDEsXHJcbiAgICAgICAgbmFtZTogJ0Vhc3knLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRWFzeSwgYWVyb2JpYyBiYXNlIGJ1aWxkaW5nJyxcclxuICAgICAgICBtaW5QZXJjZW50OiA1MCxcclxuICAgICAgICBtYXhQZXJjZW50OiA3MCxcclxuICAgICAgICBtaW5IUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuNTApLFxyXG4gICAgICAgIG1heEhSOiBNYXRoLnJvdW5kKG1heEhSICogMC43MCksXHJcbiAgICAgICAgY29sb3I6ICcjMjJjNTVlJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgbnVtYmVyOiAyLFxyXG4gICAgICAgIG5hbWU6ICdNb2RlcmF0ZScsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdNb2RlcmF0ZSwgdGVtcG8gZWZmb3J0cycsXHJcbiAgICAgICAgbWluUGVyY2VudDogNzAsXHJcbiAgICAgICAgbWF4UGVyY2VudDogODUsXHJcbiAgICAgICAgbWluSFI6IE1hdGgucm91bmQobWF4SFIgKiAwLjcwKSxcclxuICAgICAgICBtYXhIUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuODUpLFxyXG4gICAgICAgIGNvbG9yOiAnI2Y1OWUwYidcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIG51bWJlcjogMyxcclxuICAgICAgICBuYW1lOiAnSGFyZCcsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdIYXJkLCB0aHJlc2hvbGQgYW5kIFZPMiBtYXgnLFxyXG4gICAgICAgIG1pblBlcmNlbnQ6IDg1LFxyXG4gICAgICAgIG1heFBlcmNlbnQ6IDEwMCxcclxuICAgICAgICBtaW5IUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuODUpLFxyXG4gICAgICAgIG1heEhSOiBtYXhIUixcclxuICAgICAgICBjb2xvcjogJyNlZjQ0NDQnXHJcbiAgICAgIH1cclxuICAgIF1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiAnMy1ab25lIE1vZGVsJyxcclxuICAgICAgZGVzY3JpcHRpb246ICdTaW1wbGlmaWVkIDMtem9uZSBtb2RlbCBmb3IgYmVnaW5uZXJzJyxcclxuICAgICAgem9uZXNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENvZ2dhbiBQb3dlci1CYXNlZCBab25lcyBBZGFwdGVkIGZvciBIUlxyXG4gICAqL1xyXG4gIHByaXZhdGUgY3JlYXRlQ29nYW5Nb2RlbChtYXhIUjogbnVtYmVyKTogWm9uZU1vZGVsIHtcclxuICAgIGNvbnN0IHpvbmVzOiBUcmFpbmluZ1pvbmVbXSA9IFtcclxuICAgICAge1xyXG4gICAgICAgIG51bWJlcjogMSxcclxuICAgICAgICBuYW1lOiAnQWN0aXZlIFJlY292ZXJ5JyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FjdGl2ZSByZWNvdmVyeSwgPCA2OCUgbWF4IEhSJyxcclxuICAgICAgICBtaW5QZXJjZW50OiA1MCxcclxuICAgICAgICBtYXhQZXJjZW50OiA2OCxcclxuICAgICAgICBtaW5IUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuNTApLFxyXG4gICAgICAgIG1heEhSOiBNYXRoLnJvdW5kKG1heEhSICogMC42OCksXHJcbiAgICAgICAgY29sb3I6ICcjMjJjNTVlJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgbnVtYmVyOiAyLFxyXG4gICAgICAgIG5hbWU6ICdFbmR1cmFuY2UnLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRW5kdXJhbmNlLCA2OS04MyUgbWF4IEhSJyxcclxuICAgICAgICBtaW5QZXJjZW50OiA2OSxcclxuICAgICAgICBtYXhQZXJjZW50OiA4MyxcclxuICAgICAgICBtaW5IUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuNjkpLFxyXG4gICAgICAgIG1heEhSOiBNYXRoLnJvdW5kKG1heEhSICogMC44MyksXHJcbiAgICAgICAgY29sb3I6ICcjM2I4MmY2J1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgbnVtYmVyOiAzLFxyXG4gICAgICAgIG5hbWU6ICdUZW1wbycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdUZW1wbywgODQtOTQlIG1heCBIUicsXHJcbiAgICAgICAgbWluUGVyY2VudDogODQsXHJcbiAgICAgICAgbWF4UGVyY2VudDogOTQsXHJcbiAgICAgICAgbWluSFI6IE1hdGgucm91bmQobWF4SFIgKiAwLjg0KSxcclxuICAgICAgICBtYXhIUjogTWF0aC5yb3VuZChtYXhIUiAqIDAuOTQpLFxyXG4gICAgICAgIGNvbG9yOiAnI2Y1OWUwYidcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIG51bWJlcjogNCxcclxuICAgICAgICBuYW1lOiAnVGhyZXNob2xkJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0xhY3RhdGUgdGhyZXNob2xkLCA5NS0xMDUlIG1heCBIUicsXHJcbiAgICAgICAgbWluUGVyY2VudDogOTUsXHJcbiAgICAgICAgbWF4UGVyY2VudDogMTA1LFxyXG4gICAgICAgIG1pbkhSOiBNYXRoLnJvdW5kKG1heEhSICogMC45NSksXHJcbiAgICAgICAgbWF4SFI6IE1hdGgubWluKE1hdGgucm91bmQobWF4SFIgKiAxLjA1KSwgbWF4SFIpLFxyXG4gICAgICAgIGNvbG9yOiAnI2Y5NzMxNidcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIG51bWJlcjogNSxcclxuICAgICAgICBuYW1lOiAnVk8yIE1heCcsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdWTzIgbWF4LCAxMDYlKyBtYXggSFInLFxyXG4gICAgICAgIG1pblBlcmNlbnQ6IDEwNixcclxuICAgICAgICBtYXhQZXJjZW50OiAxMjAsXHJcbiAgICAgICAgbWluSFI6IE1hdGgucm91bmQobWF4SFIgKiAxLjA2KSxcclxuICAgICAgICBtYXhIUjogTWF0aC5yb3VuZChtYXhIUiAqIDEuMjApLFxyXG4gICAgICAgIGNvbG9yOiAnI2VmNDQ0NCdcclxuICAgICAgfVxyXG4gICAgXVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6ICdDb2dnYW4gTW9kZWwnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvZ2dhbi1zdHlsZSB6b25lcyBhZGFwdGVkIGZvciBoZWFydCByYXRlJyxcclxuICAgICAgem9uZXNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhlbHBlciBmdW5jdGlvbnNcclxuICAgKi9cclxuICBwcml2YXRlIGdldEVtcHR5SGVhcnRSYXRlU3RhdHMoKTogSGVhcnRSYXRlU3RhdHMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbWF4SGVhcnRSYXRlOiBudWxsLFxyXG4gICAgICBhdmVyYWdlSGVhcnRSYXRlOiBudWxsLFxyXG4gICAgICByZXN0aW5nSGVhcnRSYXRlOiBudWxsLFxyXG4gICAgICBhY3Rpdml0aWVzV2l0aEhSOiAwLFxyXG4gICAgICB0b3RhbEFjdGl2aXRpZXM6IDAsXHJcbiAgICAgIGhyRGF0YVF1YWxpdHk6ICdub25lJyxcclxuICAgICAgcGVyY2VudGlsZXM6IHtcclxuICAgICAgICBwNTA6IG51bGwsXHJcbiAgICAgICAgcDc1OiBudWxsLFxyXG4gICAgICAgIHA4NTogbnVsbCxcclxuICAgICAgICBwOTA6IG51bGwsXHJcbiAgICAgICAgcDk1OiBudWxsLFxyXG4gICAgICAgIHA5OTogbnVsbFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFBlcmNlbnRpbGUoc29ydGVkQXJyYXk6IG51bWJlcltdLCBwZXJjZW50aWxlOiBudW1iZXIpOiBudW1iZXIgfCBudWxsIHtcclxuICAgIGlmIChzb3J0ZWRBcnJheS5sZW5ndGggPT09IDApIHJldHVybiBudWxsXHJcbiAgICBcclxuICAgIC8vIFVzZSBsaW5lYXIgaW50ZXJwb2xhdGlvbiBtZXRob2QgKFItNi9FeGNlbCBtZXRob2QpXHJcbiAgICBjb25zdCBuID0gc29ydGVkQXJyYXkubGVuZ3RoXHJcbiAgICBjb25zdCByYW5rID0gKHBlcmNlbnRpbGUgLyAxMDApICogKG4gKyAxKVxyXG4gICAgXHJcbiAgICBpZiAocmFuayA8PSAxKSByZXR1cm4gc29ydGVkQXJyYXlbMF1cclxuICAgIGlmIChyYW5rID49IG4pIHJldHVybiBzb3J0ZWRBcnJheVtuIC0gMV1cclxuICAgIFxyXG4gICAgY29uc3QgbG93ZXJJbmRleCA9IE1hdGguZmxvb3IocmFuaykgLSAxXHJcbiAgICBjb25zdCB1cHBlckluZGV4ID0gTWF0aC5jZWlsKHJhbmspIC0gMVxyXG4gICAgY29uc3Qgd2VpZ2h0ID0gcmFuayAtIE1hdGguZmxvb3IocmFuaylcclxuICAgIFxyXG4gICAgcmV0dXJuIHNvcnRlZEFycmF5W2xvd2VySW5kZXhdICsgd2VpZ2h0ICogKHNvcnRlZEFycmF5W3VwcGVySW5kZXhdIC0gc29ydGVkQXJyYXlbbG93ZXJJbmRleF0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzc2Vzc0RhdGFRdWFsaXR5KGhyQWN0aXZpdGllczogbnVtYmVyLCB0b3RhbEFjdGl2aXRpZXM6IG51bWJlcik6IEhlYXJ0UmF0ZVN0YXRzWydockRhdGFRdWFsaXR5J10ge1xyXG4gICAgY29uc3QgaHJQZXJjZW50YWdlID0gdG90YWxBY3Rpdml0aWVzID4gMCA/IChockFjdGl2aXRpZXMgLyB0b3RhbEFjdGl2aXRpZXMpICogMTAwIDogMFxyXG5cclxuICAgIGlmIChoclBlcmNlbnRhZ2UgPT09IDApIHJldHVybiAnbm9uZSdcclxuICAgIGlmIChoclBlcmNlbnRhZ2UgPCAyMCB8fCBockFjdGl2aXRpZXMgPCA1KSByZXR1cm4gJ3Bvb3InXHJcbiAgICBpZiAoaHJQZXJjZW50YWdlIDwgNTAgfHwgaHJBY3Rpdml0aWVzIDwgMTApIHJldHVybiAnZmFpcidcclxuICAgIGlmIChoclBlcmNlbnRhZ2UgPCA4MCB8fCBockFjdGl2aXRpZXMgPCAyMCkgcmV0dXJuICdnb29kJ1xyXG4gICAgcmV0dXJuICdleGNlbGxlbnQnXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG5vcm1hbGl6ZVNwb3J0VHlwZShzcG9ydFR5cGU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBzcG9ydCA9IHNwb3J0VHlwZS50b0xvd2VyQ2FzZSgpXHJcbiAgICBpZiAoc3BvcnQuaW5jbHVkZXMoJ3J1bicpKSByZXR1cm4gJ1J1bm5pbmcnXHJcbiAgICBpZiAoc3BvcnQuaW5jbHVkZXMoJ3JpZGUnKSB8fCBzcG9ydC5pbmNsdWRlcygnYmlrZScpIHx8IHNwb3J0LmluY2x1ZGVzKCdjeWNsaW5nJykpIHJldHVybiAnQ3ljbGluZydcclxuICAgIGlmIChzcG9ydC5pbmNsdWRlcygnc3dpbScpKSByZXR1cm4gJ1N3aW1taW5nJ1xyXG4gICAgaWYgKHNwb3J0LmluY2x1ZGVzKCd3YWxrJykgfHwgc3BvcnQuaW5jbHVkZXMoJ2hpa2UnKSkgcmV0dXJuICdXYWxraW5nJ1xyXG4gICAgcmV0dXJuIHNwb3J0VHlwZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZWxlY3RCZXN0Wm9uZU1vZGVsKG1vZGVsczogWm9uZU1vZGVsW10pOiBab25lTW9kZWwge1xyXG4gICAgLy8gRm9yIG5vdywgZGVmYXVsdCB0byA1LXpvbmUgbW9kZWxcclxuICAgIC8vIENvdWxkIGJlIG1vcmUgaW50ZWxsaWdlbnQgYmFzZWQgb24gdXNlciBkYXRhIGluIHRoZSBmdXR1cmVcclxuICAgIHJldHVybiBtb2RlbHMuZmluZChtID0+IG0ubmFtZSA9PT0gJzUtWm9uZSBNb2RlbCcpIHx8IG1vZGVsc1swXVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVDb25maWRlbmNlKHN0YXRzOiBIZWFydFJhdGVTdGF0cyk6ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdycge1xyXG4gICAgaWYgKHN0YXRzLmhyRGF0YVF1YWxpdHkgPT09ICdleGNlbGxlbnQnICYmIHN0YXRzLmFjdGl2aXRpZXNXaXRoSFIgPj0gMjApIHJldHVybiAnaGlnaCdcclxuICAgIGlmIChzdGF0cy5ockRhdGFRdWFsaXR5ID09PSAnZ29vZCcgJiYgc3RhdHMuYWN0aXZpdGllc1dpdGhIUiA+PSAxMCkgcmV0dXJuICdtZWRpdW0nXHJcbiAgICByZXR1cm4gJ2xvdydcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoc3RhdHM6IEhlYXJ0UmF0ZVN0YXRzLCBzcG9ydEFuYWx5c2lzOiBTcG9ydFNwZWNpZmljQW5hbHlzaXNbXSk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXVxyXG5cclxuICAgIGlmIChzdGF0cy5ockRhdGFRdWFsaXR5ID09PSAncG9vcicgfHwgc3RhdHMuaHJEYXRhUXVhbGl0eSA9PT0gJ25vbmUnKSB7XHJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciB1c2luZyBhIGhlYXJ0IHJhdGUgbW9uaXRvciBmb3IgbW9yZSBhY3Rpdml0aWVzIHRvIGltcHJvdmUgem9uZSBhY2N1cmFjeScpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHN0YXRzLmFjdGl2aXRpZXNXaXRoSFIgPCAxMCkge1xyXG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnTW9yZSBoZWFydCByYXRlIGRhdGEgd2lsbCBpbXByb3ZlIHpvbmUgcmVjb21tZW5kYXRpb25zJylcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc3BvcnRBbmFseXNpcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciBzcG9ydC1zcGVjaWZpYyB6b25lcyBhcyB5b3VyIGhlYXJ0IHJhdGUgcGF0dGVybnMgdmFyeSBiZXR3ZWVuIGFjdGl2aXRpZXMnKVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdGF0cy5tYXhIZWFydFJhdGUgJiYgc3RhdHMubWF4SGVhcnRSYXRlIDwgMTYwKSB7XHJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdZb3VyIG1heCBoZWFydCByYXRlIHNlZW1zIGxvdyAtIGNvbnNpZGVyIGEgbWF4IEhSIHRlc3QgZm9yIGJldHRlciBhY2N1cmFjeScpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9uc1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiVHJhaW5pbmdab25lQW5hbHlzaXMiLCJjb25zdHJ1Y3RvciIsInN1cGFiYXNlIiwiY3JlYXRlQ2xpZW50IiwiYW5hbHl6ZVVzZXJab25lcyIsInVzZXJJZCIsImNvbnNvbGUiLCJsb2ciLCJoclN0YXRzIiwiZ2V0SGVhcnRSYXRlU3RhdGlzdGljcyIsInNwb3J0QW5hbHlzaXMiLCJnZXRTcG9ydFNwZWNpZmljQW5hbHlzaXMiLCJyZWNvbW1lbmRhdGlvbnMiLCJnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyIsInpvbmVNb2RlbHMiLCJjcmVhdGVab25lTW9kZWxzIiwibWF4SGVhcnRSYXRlIiwic3VnZ2VzdGVkTW9kZWwiLCJzZWxlY3RCZXN0Wm9uZU1vZGVsIiwiY29uZmlkZW5jZSIsImNhbGN1bGF0ZUNvbmZpZGVuY2UiLCJvdmVyYWxsIiwic3BvcnRTcGVjaWZpYyIsInN1Z2dlc3RlZFpvbmVNb2RlbCIsImFsdGVybmF0aXZlTW9kZWxzIiwiZmlsdGVyIiwibSIsIm5hbWUiLCJuZWVkc01vcmVEYXRhIiwiaHJEYXRhUXVhbGl0eSIsImVycm9yIiwiZGF0YSIsImFjdGl2aXRpZXMiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJvcmRlciIsImFzY2VuZGluZyIsImxlbmd0aCIsImdldEVtcHR5SGVhcnRSYXRlU3RhdHMiLCJockFjdGl2aXRpZXMiLCJhIiwiaGFzX2hlYXJ0cmF0ZSIsImF2ZXJhZ2VfaGVhcnRyYXRlIiwidG90YWxBY3Rpdml0aWVzIiwiYWN0aXZpdGllc1dpdGhIUiIsIk1hdGgiLCJtYXgiLCJtYXAiLCJtYXhfaGVhcnRyYXRlIiwiYXZnSGVhcnRSYXRlcyIsImhyIiwiYXZlcmFnZUhlYXJ0UmF0ZSIsInJlZHVjZSIsInN1bSIsInNvcnRlZEF2Z0hSIiwic29ydCIsImIiLCJyZXN0aW5nSGVhcnRSYXRlIiwiZmxvb3IiLCJtYXhIUnMiLCJwZXJjZW50aWxlcyIsInA1MCIsImdldFBlcmNlbnRpbGUiLCJwNzUiLCJwODUiLCJwOTAiLCJwOTUiLCJwOTkiLCJhc3Nlc3NEYXRhUXVhbGl0eSIsInJvdW5kIiwic3BvcnREYXRhIiwibm90Iiwic3BvcnRHcm91cHMiLCJncm91cHMiLCJhY3Rpdml0eSIsInNwb3J0Iiwibm9ybWFsaXplU3BvcnRUeXBlIiwic3BvcnRfdHlwZSIsInB1c2giLCJPYmplY3QiLCJlbnRyaWVzIiwiaGVhcnRSYXRlcyIsInVuZGVmaW5lZCIsIm1heEhSIiwiYXZnSFJzIiwiYXZnSFIiLCJhY3Rpdml0eUNvdW50Iiwic3VnZ2VzdGVkWm9uZXMiLCJ6b25lcyIsImVzdGltYXRlZE1heEhSIiwiY3JlYXRlRml2ZVpvbmVNb2RlbCIsImNyZWF0ZVRocmVlWm9uZU1vZGVsIiwiY3JlYXRlQ29nYW5Nb2RlbCIsIm51bWJlciIsImRlc2NyaXB0aW9uIiwibWluUGVyY2VudCIsIm1heFBlcmNlbnQiLCJtaW5IUiIsImNvbG9yIiwibWluIiwic29ydGVkQXJyYXkiLCJwZXJjZW50aWxlIiwibiIsInJhbmsiLCJsb3dlckluZGV4IiwidXBwZXJJbmRleCIsImNlaWwiLCJ3ZWlnaHQiLCJoclBlcmNlbnRhZ2UiLCJzcG9ydFR5cGUiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwibW9kZWxzIiwiZmluZCIsInN0YXRzIl0sIm1hcHBpbmdzIjoiOzs7OytCQXNEYUE7OztlQUFBQTs7O3dCQXREZ0I7QUFzRHRCLE1BQU1BO0lBR1hDLGFBQWM7UUFDWixJQUFJLENBQUNDLFFBQVEsR0FBR0MsSUFBQUEsb0JBQVk7SUFDOUI7SUFFQTs7R0FFQyxHQUNELE1BQU1DLGlCQUFpQkMsTUFBYyxFQUErQjtRQUNsRUMsUUFBUUMsR0FBRyxDQUFDLENBQUMsb0NBQW9DLEVBQUVGLFFBQVE7UUFFM0QsSUFBSTtZQUNGLCtDQUErQztZQUMvQyxNQUFNRyxVQUFVLE1BQU0sSUFBSSxDQUFDQyxzQkFBc0IsQ0FBQ0o7WUFDbERDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxFQUFFQztZQUU1QixpQ0FBaUM7WUFDakMsTUFBTUUsZ0JBQWdCLE1BQU0sSUFBSSxDQUFDQyx3QkFBd0IsQ0FBQ047WUFDMURDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLEVBQUVHO1lBRXJDLG1DQUFtQztZQUNuQyxNQUFNRSxrQkFBa0IsSUFBSSxDQUFDQyx1QkFBdUIsQ0FBQ0wsU0FBU0U7WUFFOUQsd0JBQXdCO1lBQ3hCLE1BQU1JLGFBQWEsSUFBSSxDQUFDQyxnQkFBZ0IsQ0FBQ1AsUUFBUVEsWUFBWTtZQUU3RCw0QkFBNEI7WUFDNUIsTUFBTUMsaUJBQWlCLElBQUksQ0FBQ0MsbUJBQW1CLENBQUNKO1lBRWhELGdDQUFnQztZQUNoQyxNQUFNSyxhQUFhLElBQUksQ0FBQ0MsbUJBQW1CLENBQUNaO1lBRTVDLE9BQU87Z0JBQ0xh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