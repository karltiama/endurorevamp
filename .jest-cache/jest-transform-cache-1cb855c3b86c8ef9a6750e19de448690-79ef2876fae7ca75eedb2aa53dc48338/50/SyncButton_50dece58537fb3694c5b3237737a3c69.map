{"version":3,"sources":["C:\\Users\\tiama\\Desktop\\Coding\\endurorevamp\\components\\strava\\SyncButton.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Button } from '@/components/ui/button';\r\nimport { useStravaSync } from '@/hooks/use-strava-sync'; // Use the working API version\r\nimport { Loader2, RefreshCw, CheckCircle, AlertCircle } from 'lucide-react';\r\n\r\nexport function SyncButton() {\r\n  const { \r\n    customSync, \r\n    isSyncing, \r\n    syncError, \r\n    syncResult,\r\n    syncStatus,\r\n    isLoadingStatus \r\n  } = useStravaSync();\r\n\r\n  const handleSync = async () => {\r\n    console.log('üîÑ SyncButton: Starting sync process');\r\n    try {\r\n      // Use the working API route approach\r\n      customSync({\r\n        maxActivities: 50,\r\n        sinceDays: 30,\r\n      });\r\n    } catch (err) {\r\n      console.error('‚ùå SyncButton: Sync failed:', err);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = () => {\r\n    if (isSyncing) {\r\n      return <Loader2 className=\"h-4 w-4 animate-spin\" />;\r\n    }\r\n    \r\n    if (syncError) {\r\n      return <AlertCircle className=\"h-4 w-4 text-red-500\" />;\r\n    }\r\n    \r\n    if (syncResult?.success) {\r\n      return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n    }\r\n    \r\n    return <RefreshCw className=\"h-4 w-4\" />;\r\n  };\r\n\r\n  // Debug logging for hook state changes\r\n  console.log('üîç SyncButton state:', {\r\n    isSyncing,\r\n    hasError: !!syncError,\r\n    syncError: syncError?.message,\r\n    syncResult,\r\n    hasLastResult: !!syncResult\r\n  });\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <Button\r\n        onClick={handleSync}\r\n        disabled={isSyncing || isLoadingStatus}\r\n        className=\"w-full\"\r\n      >\r\n        {getStatusIcon()}\r\n        <span className=\"ml-2\">\r\n          {isSyncing ? 'Syncing...' : 'Sync Strava Data'}\r\n        </span>\r\n      </Button>\r\n\r\n      {syncError && (\r\n        <div className=\"text-sm text-red-600 bg-red-50 p-3 rounded\">\r\n          <strong>Error:</strong> {syncError.message}\r\n          <details className=\"mt-2\">\r\n            <summary className=\"cursor-pointer text-xs\">Show debugging info</summary>\r\n            <pre className=\"mt-1 text-xs overflow-auto\">\r\n              {JSON.stringify({ error: syncError.message, syncResult }, null, 2)}\r\n            </pre>\r\n          </details>\r\n        </div>\r\n      )}\r\n\r\n      {syncResult && !syncError && (\r\n        <div className=\"text-sm bg-gray-50 p-3 rounded space-y-1\">\r\n          <div className=\"font-medium\">Last Sync Results:</div>\r\n          <div>‚úÖ Success: {syncResult.success ? 'Yes' : 'No'}</div>\r\n          <div>üìä Activities processed: {syncResult.data?.activitiesProcessed || 0}</div>\r\n          <div>üÜï New activities: {syncResult.data?.newActivities || 0}</div>\r\n          <div>üîÑ Updated activities: {syncResult.data?.updatedActivities || 0}</div>\r\n          <div>‚è±Ô∏è Duration: {syncResult.data?.syncDuration ? `${Math.round(syncResult.data.syncDuration / 1000)}s` : 'N/A'}</div>\r\n          {syncResult.errors && syncResult.errors.length > 0 && (\r\n            <div className=\"text-red-600 text-xs mt-2\">\r\n              <strong>Warnings/Errors:</strong>\r\n              <ul className=\"list-disc list-inside\">\r\n                {syncResult.errors.map((err: string, idx: number) => (\r\n                  <li key={idx}>{err}</li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {syncStatus && (\r\n        <div className=\"text-xs text-gray-500 bg-gray-50 p-2 rounded\">\r\n          <div>Status: {syncStatus.canSync ? '‚úÖ Ready to sync' : '‚è≥ Sync cooldown'}</div>\r\n          <div>Activities: {syncStatus.activityCount}</div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} "],"names":["SyncButton","customSync","isSyncing","syncError","syncResult","syncStatus","isLoadingStatus","useStravaSync","handleSync","console","log","maxActivities","sinceDays","err","error","getStatusIcon","Loader2","className","AlertCircle","success","CheckCircle","RefreshCw","hasError","message","hasLastResult","div","Button","onClick","disabled","span","strong","details","summary","pre","JSON","stringify","data","activitiesProcessed","newActivities","updatedActivities","syncDuration","Math","round","errors","length","ul","map","idx","li","canSync","activityCount"],"mappings":"AAAA;;;;;+BAMgBA;;;eAAAA;;;;wBAJO;+BACO;6BAC+B;AAEtD,SAASA;IACd,MAAM,EACJC,UAAU,EACVC,SAAS,EACTC,SAAS,EACTC,UAAU,EACVC,UAAU,EACVC,eAAe,EAChB,GAAGC,IAAAA,4BAAa;IAEjB,MAAMC,aAAa;QACjBC,QAAQC,GAAG,CAAC;QACZ,IAAI;YACF,qCAAqC;YACrCT,WAAW;gBACTU,eAAe;gBACfC,WAAW;YACb;QACF,EAAE,OAAOC,KAAK;YACZJ,QAAQK,KAAK,CAAC,8BAA8BD;QAC9C;IACF;IAEA,MAAME,gBAAgB;QACpB,IAAIb,WAAW;YACb,qBAAO,qBAACc,oBAAO;gBAACC,WAAU;;QAC5B;QAEA,IAAId,WAAW;YACb,qBAAO,qBAACe,wBAAW;gBAACD,WAAU;;QAChC;QAEA,IAAIb,YAAYe,SAAS;YACvB,qBAAO,qBAACC,wBAAW;gBAACH,WAAU;;QAChC;QAEA,qBAAO,qBAACI,sBAAS;YAACJ,WAAU;;IAC9B;IAEA,uCAAuC;IACvCR,QAAQC,GAAG,CAAC,wBAAwB;QAClCR;QACAoB,UAAU,CAAC,CAACnB;QACZA,WAAWA,WAAWoB;QACtBnB;QACAoB,eAAe,CAAC,CAACpB;IACnB;IAEA,qBACE,sBAACqB;QAAIR,WAAU;;0BACb,sBAACS,cAAM;gBACLC,SAASnB;gBACToB,UAAU1B,aAAaI;gBACvBW,WAAU;;oBAETF;kCACD,qBAACc;wBAAKZ,WAAU;kCACbf,YAAY,eAAe;;;;YAI/BC,2BACC,sBAACsB;gBAAIR,WAAU;;kCACb,qBAACa;kCAAO;;oBAAe;oBAAE3B,UAAUoB,OAAO;kCAC1C,sBAACQ;wBAAQd,WAAU;;0CACjB,qBAACe;gCAAQf,WAAU;0CAAyB;;0CAC5C,qBAACgB;gCAAIhB,WAAU;0CACZiB,KAAKC,SAAS,CAAC;oCAAErB,OAAOX,UAAUoB,OAAO;oCAAEnB;gCAAW,GAAG,MAAM;;;;;;YAMvEA,cAAc,CAACD,2BACd,sBAACsB;gBAAIR,WAAU;;kCACb,qBAACQ;wBAAIR,WAAU;kCAAc;;kCAC7B,sBAACQ;;4BAAI;4BAAYrB,WAAWe,OAAO,GAAG,QAAQ;;;kCAC9C,sBAACM;;4BAAI;4BAA0BrB,WAAWgC,IAAI,EAAEC,uBAAuB;;;kCACvE,sBAACZ;;4BAAI;4BAAoBrB,WAAWgC,IAAI,EAAEE,iBAAiB;;;kCAC3D,sBAACb;;4BAAI;4BAAwBrB,WAAWgC,IAAI,EAAEG,qBAAqB;;;kCACnE,sBAACd;;4BAAI;4BAAcrB,WAAWgC,IAAI,EAAEI,eAAe,GAAGC,KAAKC,KAAK,CAACtC,WAAWgC,IAAI,CAACI,YAAY,GAAG,MAAM,CAAC,CAAC,GAAG;;;oBAC1GpC,WAAWuC,MAAM,IAAIvC,WAAWuC,MAAM,CAACC,MAAM,GAAG,mBAC/C,sBAACnB;wBAAIR,WAAU;;0CACb,qBAACa;0CAAO;;0CACR,qBAACe;gCAAG5B,WAAU;0CACXb,WAAWuC,MAAM,CAACG,GAAG,CAAC,CAACjC,KAAakC,oBACnC,qBAACC;kDAAcnC;uCAANkC;;;;;;YAQpB1C,4BACC,sBAACoB;gBAAIR,WAAU;;kCACb,sBAACQ;;4BAAI;4BAASpB,WAAW4C,OAAO,GAAG,oBAAoB;;;kCACvD,sBAACxB;;4BAAI;4BAAapB,WAAW6C,aAAa;;;;;;;AAKpD"}