{"version":3,"sources":["C:\\Users\\tiama\\Desktop\\Coding\\endurorevamp\\components\\strava\\StravaReconnectionPrompt.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Button } from '@/components/ui/button'\r\nimport { Alert, AlertDescription } from '@/components/ui/alert'\r\nimport { getStravaAuthUrl } from '@/lib/strava'\r\nimport { Link2, RefreshCw, AlertCircle, Info } from 'lucide-react'\r\n\r\ninterface StravaReconnectionPromptProps {\r\n  error?: string | null\r\n  onRefresh?: () => Promise<void>\r\n  title?: string\r\n  className?: string\r\n}\r\n\r\nexport function StravaReconnectionPrompt({ \r\n  error, \r\n  onRefresh, \r\n  title = \"Strava Connection Issue\",\r\n  className = \"\"\r\n}: StravaReconnectionPromptProps) {\r\n  const handleReconnect = () => {\r\n    const authUrl = getStravaAuthUrl(window.location.origin)\r\n    window.location.href = authUrl\r\n  }\r\n\r\n  const handleRefresh = async () => {\r\n    if (!onRefresh) {\r\n      handleReconnect()\r\n      return\r\n    }\r\n\r\n    try {\r\n      await onRefresh()\r\n    } catch (err) {\r\n      console.error('Failed to refresh token:', err)\r\n      // If refresh fails, redirect to full OAuth flow\r\n      handleReconnect()\r\n    }\r\n  }\r\n\r\n  // Determine the type of error and show appropriate messaging\r\n  const isTokenExpired = error?.includes('expired') || error?.includes('401') || error?.includes('invalid')\r\n  const isNetworkError = error?.includes('network') || error?.includes('fetch')\r\n  \r\n  return (\r\n    <div className={`bg-white border border-gray-200 rounded-lg p-6 ${className}`}>\r\n      <div className=\"flex items-start space-x-4\">\r\n        <div className=\"flex-shrink-0\">\r\n          <AlertCircle className=\"h-6 w-6 text-orange-500\" />\r\n        </div>\r\n        <div className=\"flex-1 space-y-4\">\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n              {isTokenExpired ? 'Strava Connection Expired' : title}\r\n            </h3>\r\n            \r\n            {isTokenExpired ? (\r\n              <div className=\"space-y-3\">\r\n                <p className=\"text-gray-600\">\r\n                  Your Strava connection has expired. This is normal and happens periodically for security reasons.\r\n                </p>\r\n                <Alert className=\"bg-blue-50 border-blue-200\">\r\n                  <Info className=\"h-4 w-4 text-blue-600\" />\r\n                  <AlertDescription className=\"text-blue-800\">\r\n                    <strong>Quick fix:</strong> Click &quot;Reconnect to Strava&quot; below to restore access to your activities and continue viewing your data.\r\n                  </AlertDescription>\r\n                </Alert>\r\n              </div>\r\n            ) : isNetworkError ? (\r\n              <div className=\"space-y-3\">\r\n                <p className=\"text-gray-600\">\r\n                  There&apos;s a temporary connection issue with Strava. This usually resolves itself quickly.\r\n                </p>\r\n                <Alert className=\"bg-yellow-50 border-yellow-200\">\r\n                  <Info className=\"h-4 w-4 text-yellow-600\" />\r\n                  <AlertDescription className=\"text-yellow-800\">\r\n                    Try refreshing your connection first, or reconnect if the issue persists.\r\n                  </AlertDescription>\r\n                </Alert>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                <p className=\"text-gray-600\">\r\n                  Unable to connect to Strava. This might be due to an expired connection or configuration issue.\r\n                </p>\r\n                {error && (\r\n                  <div className=\"text-sm text-gray-500 bg-gray-50 p-3 rounded border\">\r\n                    <strong>Error details:</strong> {error}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex flex-col sm:flex-row gap-3\">\r\n            {onRefresh && (isNetworkError || !isTokenExpired) && (\r\n              <Button\r\n                onClick={handleRefresh}\r\n                variant=\"outline\"\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <RefreshCw className=\"h-4 w-4\" />\r\n                Refresh Connection\r\n              </Button>\r\n            )}\r\n            \r\n            <Button\r\n              onClick={handleReconnect}\r\n              className=\"flex items-center gap-2 bg-orange-600 hover:bg-orange-700\"\r\n            >\r\n              <Link2 className=\"h-4 w-4\" />\r\n              {isTokenExpired ? 'Reconnect to Strava' : 'Connect to Strava'}\r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"text-sm text-gray-500\">\r\n            <p className=\"font-medium mb-1\">After reconnecting, you&apos;ll be able to:</p>\r\n            <ul className=\"space-y-1 text-xs ml-4\">\r\n              <li>• View your recent activity data and analytics</li>\r\n              <li>• Sync new activities automatically</li>\r\n              <li>• Access detailed performance metrics</li>\r\n              <li>• Track your training progress over time</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n} "],"names":["StravaReconnectionPrompt","error","onRefresh","title","className","handleReconnect","authUrl","getStravaAuthUrl","window","location","origin","href","handleRefresh","err","console","isTokenExpired","includes","isNetworkError","div","AlertCircle","h3","p","Alert","Info","AlertDescription","strong","Button","onClick","variant","RefreshCw","Link2","ul","li"],"mappings":"AAAA;;;;;+BAcgBA;;;eAAAA;;;;wBAZO;uBACiB;wBACP;6BACmB;AAS7C,SAASA,yBAAyB,EACvCC,KAAK,EACLC,SAAS,EACTC,QAAQ,yBAAyB,EACjCC,YAAY,EAAE,EACgB;IAC9B,MAAMC,kBAAkB;QACtB,MAAMC,UAAUC,IAAAA,wBAAgB,EAACC,OAAOC,QAAQ,CAACC,MAAM;QACvDF,OAAOC,QAAQ,CAACE,IAAI,GAAGL;IACzB;IAEA,MAAMM,gBAAgB;QACpB,IAAI,CAACV,WAAW;YACdG;YACA;QACF;QAEA,IAAI;YACF,MAAMH;QACR,EAAE,OAAOW,KAAK;YACZC,QAAQb,KAAK,CAAC,4BAA4BY;YAC1C,gDAAgD;YAChDR;QACF;IACF;IAEA,6DAA6D;IAC7D,MAAMU,iBAAiBd,OAAOe,SAAS,cAAcf,OAAOe,SAAS,UAAUf,OAAOe,SAAS;IAC/F,MAAMC,iBAAiBhB,OAAOe,SAAS,cAAcf,OAAOe,SAAS;IAErE,qBACE,qBAACE;QAAId,WAAW,CAAC,+CAA+C,EAAEA,WAAW;kBAC3E,cAAA,sBAACc;YAAId,WAAU;;8BACb,qBAACc;oBAAId,WAAU;8BACb,cAAA,qBAACe,wBAAW;wBAACf,WAAU;;;8BAEzB,sBAACc;oBAAId,WAAU;;sCACb,sBAACc;;8CACC,qBAACE;oCAAGhB,WAAU;8CACXW,iBAAiB,8BAA8BZ;;gCAGjDY,+BACC,sBAACG;oCAAId,WAAU;;sDACb,qBAACiB;4CAAEjB,WAAU;sDAAgB;;sDAG7B,sBAACkB,YAAK;4CAAClB,WAAU;;8DACf,qBAACmB,iBAAI;oDAACnB,WAAU;;8DAChB,sBAACoB,uBAAgB;oDAACpB,WAAU;;sEAC1B,qBAACqB;sEAAO;;wDAAmB;;;;;;qCAI/BR,+BACF,sBAACC;oCAAId,WAAU;;sDACb,qBAACiB;4CAAEjB,WAAU;sDAAgB;;sDAG7B,sBAACkB,YAAK;4CAAClB,WAAU;;8DACf,qBAACmB,iBAAI;oDAACnB,WAAU;;8DAChB,qBAACoB,uBAAgB;oDAACpB,WAAU;8DAAkB;;;;;mDAMlD,sBAACc;oCAAId,WAAU;;sDACb,qBAACiB;4CAAEjB,WAAU;sDAAgB;;wCAG5BH,uBACC,sBAACiB;4CAAId,WAAU;;8DACb,qBAACqB;8DAAO;;gDAAuB;gDAAExB;;;;;;;sCAO3C,sBAACiB;4BAAId,WAAU;;gCACZF,aAAce,CAAAA,kBAAkB,CAACF,cAAa,mBAC7C,sBAACW,cAAM;oCACLC,SAASf;oCACTgB,SAAQ;oCACRxB,WAAU;;sDAEV,qBAACyB,sBAAS;4CAACzB,WAAU;;wCAAY;;;8CAKrC,sBAACsB,cAAM;oCACLC,SAAStB;oCACTD,WAAU;;sDAEV,qBAAC0B,kBAAK;4CAAC1B,WAAU;;wCAChBW,iBAAiB,wBAAwB;;;;;sCAI9C,sBAACG;4BAAId,WAAU;;8CACb,qBAACiB;oCAAEjB,WAAU;8CAAmB;;8CAChC,sBAAC2B;oCAAG3B,WAAU;;sDACZ,qBAAC4B;sDAAG;;sDACJ,qBAACA;sDAAG;;sDACJ,qBAACA;sDAAG;;sDACJ,qBAACA;sDAAG;;;;;;;;;;;AAOlB"}