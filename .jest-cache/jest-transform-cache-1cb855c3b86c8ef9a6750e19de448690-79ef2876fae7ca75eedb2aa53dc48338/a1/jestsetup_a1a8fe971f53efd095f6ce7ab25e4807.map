{"version":3,"sources":["C:\\Users\\tiama\\Desktop\\Coding\\endurorevamp\\jest.setup.js"],"sourcesContent":["// Global test setup\r\nimport '@testing-library/jest-dom'\r\n\r\n// Create global router mocks that can be overridden in tests\r\nconst mockRouterFunctions = {\r\n  push: jest.fn(),\r\n  replace: jest.fn(),\r\n  back: jest.fn(),\r\n  forward: jest.fn(),\r\n  refresh: jest.fn(),\r\n  prefetch: jest.fn(),\r\n}\r\n\r\n// Mock Next.js server-side functions globally\r\njest.mock('next/navigation', () => ({\r\n  useRouter: jest.fn(() => mockRouterFunctions),\r\n  useSearchParams: () => new URLSearchParams(),\r\n  usePathname: () => '/',\r\n  redirect: jest.fn(),\r\n  __mockRouterFunctions: mockRouterFunctions, // Export for test access\r\n}))\r\n\r\n// Mock Next.js cookies and headers (server-side)\r\njest.mock('next/headers', () => ({\r\n  cookies: () => ({\r\n    get: jest.fn(),\r\n    set: jest.fn(),\r\n    delete: jest.fn(),\r\n  }),\r\n  headers: () => ({\r\n    get: jest.fn(),\r\n  }),\r\n}))\r\n\r\n// Mock Supabase clients globally to prevent server-side call issues\r\njest.mock('@/lib/supabase/client', () => ({\r\n  createClient: jest.fn(() => ({\r\n    auth: {\r\n      getUser: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\r\n      onAuthStateChange: jest.fn(() => ({ data: { subscription: { unsubscribe: jest.fn() } } })),\r\n      signOut: jest.fn().mockResolvedValue({ error: null }),\r\n    },\r\n    from: jest.fn(() => ({\r\n      select: jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          single: jest.fn().mockResolvedValue({ data: null, error: null }),\r\n          limit: jest.fn(() => ({\r\n            order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n          })),\r\n        })),\r\n        order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n      })),\r\n      insert: jest.fn(() => ({\r\n        select: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n      })),\r\n      update: jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          select: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n        })),\r\n      })),\r\n      upsert: jest.fn(() => ({\r\n        select: jest.fn(() => ({\r\n          single: jest.fn().mockResolvedValue({ data: {}, error: null }),\r\n        })),\r\n      })),\r\n    })),\r\n  })),\r\n}))\r\n\r\njest.mock('@/lib/supabase/server', () => ({\r\n  createClient: jest.fn(() => ({\r\n    auth: {\r\n      getUser: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\r\n    },\r\n    from: jest.fn(() => ({\r\n      select: jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          single: jest.fn().mockResolvedValue({ data: null, error: null }),\r\n          limit: jest.fn(() => ({\r\n            order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n          })),\r\n        })),\r\n        order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n      })),\r\n    })),\r\n  })),\r\n}))\r\n\r\n// Mock common application hooks globally\r\njest.mock('@/hooks/useGoals', () => ({\r\n  useUserGoals: jest.fn(() => ({ data: { goals: [], onboarding: null }, isLoading: false, error: null, refetch: jest.fn() })),\r\n  useUpdateGoal: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n  useCreateGoal: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n  useDeleteGoal: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n  useGoalTypes: jest.fn(() => ({ data: [], isLoading: false, error: null })),\r\n  useCreateMultipleGoals: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n}))\r\n\r\njest.mock('@/hooks/use-user-activities', () => ({\r\n  useUserActivities: jest.fn(() => ({ data: [], isLoading: false, error: null, refetch: jest.fn() })),\r\n}))\r\n\r\njest.mock('@/hooks/use-strava-sync', () => {\r\n  const mockSyncStatusInfo = {\r\n    lastSyncText: 'Never synced',\r\n    canSync: true,\r\n    syncDisabledReason: null,\r\n    activityCount: 0,\r\n    todaySyncs: 0,\r\n    maxSyncs: 5,\r\n    consecutiveErrors: 0,\r\n    lastError: null\r\n  }\r\n\r\n  return {\r\n    useStravaSync: jest.fn(() => ({\r\n      // Status\r\n      syncStatus: null,\r\n      isLoadingStatus: false,\r\n      statusError: null,\r\n      \r\n      // Sync controls\r\n      syncLatest: jest.fn(),\r\n      syncLastWeek: jest.fn(),\r\n      syncLastMonth: jest.fn(),\r\n      forceFullSync: jest.fn(),\r\n      customSync: jest.fn(),\r\n      \r\n      // Sync state\r\n      isSyncing: false,\r\n      syncError: null,\r\n      syncResult: null,\r\n      \r\n      // Manual controls\r\n      refetchStatus: jest.fn(),\r\n      refreshStatus: jest.fn(),\r\n      \r\n      // Formatted sync info\r\n      syncStatusInfo: mockSyncStatusInfo\r\n    })),\r\n    useSyncStatusInfo: jest.fn(() => mockSyncStatusInfo),\r\n  }\r\n})\r\n\r\njest.mock('@/hooks/useUnitPreferences', () => {\r\n  const mockSetDistanceUnit = jest.fn()\r\n  const mockToggleUnits = jest.fn()\r\n  const mockUpdatePreferences = jest.fn()\r\n  \r\n  return {\r\n    useUnitPreferences: jest.fn(() => ({\r\n      preferences: { distance: 'km', pace: 'min/km' },\r\n      updatePreferences: mockUpdatePreferences,\r\n      setDistanceUnit: mockSetDistanceUnit,\r\n      toggleUnits: mockToggleUnits,\r\n      isLoading: false\r\n    })),\r\n    __mocks: {\r\n      setDistanceUnit: mockSetDistanceUnit,\r\n      toggleUnits: mockToggleUnits,\r\n      updatePreferences: mockUpdatePreferences,\r\n    }\r\n  }\r\n})\r\n\r\njest.mock('@/providers/AuthProvider', () => ({\r\n  useAuth: jest.fn(() => ({\r\n    user: null,\r\n    isLoading: false,\r\n    isAuthenticated: false,\r\n    signOut: jest.fn(),\r\n    refreshUser: jest.fn()\r\n  })),\r\n}))\r\n\r\n// Mock environment variables\r\nprocess.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co'\r\nprocess.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key'\r\nprocess.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key'\r\n\r\n// REMOVED: Heavy console mocking that was running before every test\r\n// REMOVED: beforeEach/afterEach hooks that were adding overhead\r\n\r\n// Mock fetch globally\r\nglobal.fetch = jest.fn(() =>\r\n  Promise.resolve({\r\n    ok: true,\r\n    json: () => Promise.resolve({}),\r\n    text: () => Promise.resolve(''),\r\n    status: 200,\r\n    statusText: 'OK',\r\n  })\r\n)\r\n\r\n// Mock window.location in a safe way that works with JSDOM\r\ndelete window.location\r\nwindow.location = {\r\n  href: '',\r\n  assign: jest.fn(),\r\n  replace: jest.fn(),\r\n  reload: jest.fn(),\r\n  toString: jest.fn(() => 'http://localhost/'),\r\n}\r\n\r\n// Mock ResizeObserver\r\nglobal.ResizeObserver = jest.fn().mockImplementation(() => ({\r\n  observe: jest.fn(),\r\n  unobserve: jest.fn(),\r\n  disconnect: jest.fn(),\r\n}))\r\n\r\n// Mock IntersectionObserver\r\nglobal.IntersectionObserver = jest.fn().mockImplementation(() => ({\r\n  observe: jest.fn(),\r\n  unobserve: jest.fn(),\r\n  disconnect: jest.fn(),\r\n})) "],"names":["jest","mock","useRouter","fn","mockRouterFunctions","useSearchParams","URLSearchParams","usePathname","redirect","__mockRouterFunctions","cookies","get","set","delete","headers","createClient","auth","getUser","mockResolvedValue","data","user","error","onAuthStateChange","subscription","unsubscribe","signOut","from","select","eq","single","limit","order","insert","update","upsert","useUserGoals","goals","onboarding","isLoading","refetch","useUpdateGoal","mutate","useCreateGoal","useDeleteGoal","useGoalTypes","useCreateMultipleGoals","useUserActivities","mockSyncStatusInfo","lastSyncText","canSync","syncDisabledReason","activityCount","todaySyncs","maxSyncs","consecutiveErrors","lastError","useStravaSync","syncStatus","isLoadingStatus","statusError","syncLatest","syncLastWeek","syncLastMonth","forceFullSync","customSync","isSyncing","syncError","syncResult","refetchStatus","refreshStatus","syncStatusInfo","useSyncStatusInfo","mockSetDistanceUnit","mockToggleUnits","mockUpdatePreferences","useUnitPreferences","preferences","distance","pace","updatePreferences","setDistanceUnit","toggleUnits","__mocks","useAuth","isAuthenticated","refreshUser","push","replace","back","forward","refresh","prefetch","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_SERVICE_ROLE_KEY","global","fetch","Promise","resolve","ok","json","text","status","statusText","window","location","href","assign","reload","toString","ResizeObserver","mockImplementation","observe","unobserve","disconnect","IntersectionObserver"],"mappings":"AAAA,oBAAoB;;AAapB,8CAA8C;AAC9CA,KAAKC,IAAI,CAAC,mBAAmB,IAAO,CAAA;QAClCC,WAAWF,KAAKG,EAAE,CAAC,IAAMC;QACzBC,iBAAiB,IAAM,IAAIC;QAC3BC,aAAa,IAAM;QACnBC,UAAUR,KAAKG,EAAE;QACjBM,uBAAuBL;IACzB,CAAA;AAEA,iDAAiD;AACjDJ,KAAKC,IAAI,CAAC,gBAAgB,IAAO,CAAA;QAC/BS,SAAS,IAAO,CAAA;gBACdC,KAAKX,KAAKG,EAAE;gBACZS,KAAKZ,KAAKG,EAAE;gBACZU,QAAQb,KAAKG,EAAE;YACjB,CAAA;QACAW,SAAS,IAAO,CAAA;gBACdH,KAAKX,KAAKG,EAAE;YACd,CAAA;IACF,CAAA;AAEA,oEAAoE;AACpEH,KAAKC,IAAI,CAAC,yBAAyB,IAAO,CAAA;QACxCc,cAAcf,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAC3Ba,MAAM;oBACJC,SAASjB,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;wBAAEC,MAAM;4BAAEC,MAAM;wBAAK;wBAAGC,OAAO;oBAAK;oBACzEC,mBAAmBtB,KAAKG,EAAE,CAAC,IAAO,CAAA;4BAAEgB,MAAM;gCAAEI,cAAc;oCAAEC,aAAaxB,KAAKG,EAAE;gCAAG;4BAAE;wBAAE,CAAA;oBACvFsB,SAASzB,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;wBAAEG,OAAO;oBAAK;gBACrD;gBACAK,MAAM1B,KAAKG,EAAE,CAAC,IAAO,CAAA;wBACnBwB,QAAQ3B,KAAKG,EAAE,CAAC,IAAO,CAAA;gCACrByB,IAAI5B,KAAKG,EAAE,CAAC,IAAO,CAAA;wCACjB0B,QAAQ7B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;4CAAEC,MAAM;4CAAME,OAAO;wCAAK;wCAC9DS,OAAO9B,KAAKG,EAAE,CAAC,IAAO,CAAA;gDACpB4B,OAAO/B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;oDAAEC,MAAM,EAAE;oDAAEE,OAAO;gDAAK;4CAC7D,CAAA;oCACF,CAAA;gCACAU,OAAO/B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;oCAAEC,MAAM,EAAE;oCAAEE,OAAO;gCAAK;4BAC7D,CAAA;wBACAW,QAAQhC,KAAKG,EAAE,CAAC,IAAO,CAAA;gCACrBwB,QAAQ3B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;oCAAEC,MAAM,EAAE;oCAAEE,OAAO;gCAAK;4BAC9D,CAAA;wBACAY,QAAQjC,KAAKG,EAAE,CAAC,IAAO,CAAA;gCACrByB,IAAI5B,KAAKG,EAAE,CAAC,IAAO,CAAA;wCACjBwB,QAAQ3B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;4CAAEC,MAAM,EAAE;4CAAEE,OAAO;wCAAK;oCAC9D,CAAA;4BACF,CAAA;wBACAa,QAAQlC,KAAKG,EAAE,CAAC,IAAO,CAAA;gCACrBwB,QAAQ3B,KAAKG,EAAE,CAAC,IAAO,CAAA;wCACrB0B,QAAQ7B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;4CAAEC,MAAM,CAAC;4CAAGE,OAAO;wCAAK;oCAC9D,CAAA;4BACF,CAAA;oBACF,CAAA;YACF,CAAA;IACF,CAAA;AAEArB,KAAKC,IAAI,CAAC,yBAAyB,IAAO,CAAA;QACxCc,cAAcf,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAC3Ba,MAAM;oBACJC,SAASjB,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;wBAAEC,MAAM;4BAAEC,MAAM;wBAAK;wBAAGC,OAAO;oBAAK;gBAC3E;gBACAK,MAAM1B,KAAKG,EAAE,CAAC,IAAO,CAAA;wBACnBwB,QAAQ3B,KAAKG,EAAE,CAAC,IAAO,CAAA;gCACrByB,IAAI5B,KAAKG,EAAE,CAAC,IAAO,CAAA;wCACjB0B,QAAQ7B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;4CAAEC,MAAM;4CAAME,OAAO;wCAAK;wCAC9DS,OAAO9B,KAAKG,EAAE,CAAC,IAAO,CAAA;gDACpB4B,OAAO/B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;oDAAEC,MAAM,EAAE;oDAAEE,OAAO;gDAAK;4CAC7D,CAAA;oCACF,CAAA;gCACAU,OAAO/B,KAAKG,EAAE,GAAGe,iBAAiB,CAAC;oCAAEC,MAAM,EAAE;oCAAEE,OAAO;gCAAK;4BAC7D,CAAA;oBACF,CAAA;YACF,CAAA;IACF,CAAA;AAEA,yCAAyC;AACzCrB,KAAKC,IAAI,CAAC,oBAAoB,IAAO,CAAA;QACnCkC,cAAcnC,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEgB,MAAM;oBAAEiB,OAAO,EAAE;oBAAEC,YAAY;gBAAK;gBAAGC,WAAW;gBAAOjB,OAAO;gBAAMkB,SAASvC,KAAKG,EAAE;YAAG,CAAA;QACxHqC,eAAexC,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEsC,QAAQzC,KAAKG,EAAE;gBAAImC,WAAW;gBAAOjB,OAAO;YAAK,CAAA;QACjFqB,eAAe1C,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEsC,QAAQzC,KAAKG,EAAE;gBAAImC,WAAW;gBAAOjB,OAAO;YAAK,CAAA;QACjFsB,eAAe3C,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEsC,QAAQzC,KAAKG,EAAE;gBAAImC,WAAW;gBAAOjB,OAAO;YAAK,CAAA;QACjFuB,cAAc5C,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEgB,MAAM,EAAE;gBAAEmB,WAAW;gBAAOjB,OAAO;YAAK,CAAA;QACvEwB,wBAAwB7C,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEsC,QAAQzC,KAAKG,EAAE;gBAAImC,WAAW;gBAAOjB,OAAO;YAAK,CAAA;IAC5F,CAAA;AAEArB,KAAKC,IAAI,CAAC,+BAA+B,IAAO,CAAA;QAC9C6C,mBAAmB9C,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAAEgB,MAAM,EAAE;gBAAEmB,WAAW;gBAAOjB,OAAO;gBAAMkB,SAASvC,KAAKG,EAAE;YAAG,CAAA;IAClG,CAAA;AAEAH,KAAKC,IAAI,CAAC,2BAA2B;IACnC,MAAM8C,qBAAqB;QACzBC,cAAc;QACdC,SAAS;QACTC,oBAAoB;QACpBC,eAAe;QACfC,YAAY;QACZC,UAAU;QACVC,mBAAmB;QACnBC,WAAW;IACb;IAEA,OAAO;QACLC,eAAexD,KAAKG,EAAE,CAAC,IAAO,CAAA;gBAC5B,SAAS;gBACTsD,YAAY;gBACZC,iBAAiB;gBACjBC,aAAa;gBAEb,gBAAgB;gBAChBC,YAAY5D,KAAKG,EAAE;gBACnB0D,cAAc7D,KAAKG,EAAE;gBACrB2D,eAAe9D,KAAKG,EAAE;gBACtB4D,eAAe/D,KAAKG,EAAE;gBACtB6D,YAAYhE,KAAKG,EAAE;gBAEnB,aAAa;gBACb8D,WAAW;gBACXC,WAAW;gBACXC,YAAY;gBAEZ,kBAAkB;gBAClBC,eAAepE,KAAKG,EAAE;gBACtBkE,eAAerE,KAAKG,EAAE;gBAEtB,sBAAsB;gBACtBmE,gBAAgBvB;YAClB,CAAA;QACAwB,mBAAmBvE,KAAKG,EAAE,CAAC,IAAM4C;IACnC;AACF;AAEA/C,KAAKC,IAAI,CAAC,8BAA8B;IACtC,MAAMuE,sBAAsBxE,KAAKG,EAAE;IACnC,MAAMsE,kBAAkBzE,KAAKG,EAAE;IAC/B,MAAMuE,wBAAwB1E,KAAKG,EAAE;IAErC,OAAO;QACLwE,oBAAoB3E,KAAKG,EAAE,CAAC,IAAO,CAAA;gBACjCyE,aAAa;oBAAEC,UAAU;oBAAMC,MAAM;gBAAS;gBAC9CC,mBAAmBL;gBACnBM,iBAAiBR;gBACjBS,aAAaR;gBACbnC,WAAW;YACb,CAAA;QACA4C,SAAS;YACPF,iBAAiBR;YACjBS,aAAaR;YACbM,mBAAmBL;QACrB;IACF;AACF;AAEA1E,KAAKC,IAAI,CAAC,4BAA4B,IAAO,CAAA;QAC3CkF,SAASnF,KAAKG,EAAE,CAAC,IAAO,CAAA;gBACtBiB,MAAM;gBACNkB,WAAW;gBACX8C,iBAAiB;gBACjB3D,SAASzB,KAAKG,EAAE;gBAChBkF,aAAarF,KAAKG,EAAE;YACtB,CAAA;IACF,CAAA;;;;QA5KO;AAEP,6DAA6D;AAC7D,MAAMC,sBAAsB;IAC1BkF,MAAMtF,KAAKG,EAAE;IACboF,SAASvF,KAAKG,EAAE;IAChBqF,MAAMxF,KAAKG,EAAE;IACbsF,SAASzF,KAAKG,EAAE;IAChBuF,SAAS1F,KAAKG,EAAE;IAChBwF,UAAU3F,KAAKG,EAAE;AACnB;AAoKA,6BAA6B;AAC7ByF,QAAQC,GAAG,CAACC,wBAAwB,GAAG;AACvCF,QAAQC,GAAG,CAACE,6BAA6B,GAAG;AAC5CH,QAAQC,GAAG,CAACG,yBAAyB,GAAG;AAExC,oEAAoE;AACpE,gEAAgE;AAEhE,sBAAsB;AACtBC,OAAOC,KAAK,GAAGlG,KAAKG,EAAE,CAAC,IACrBgG,QAAQC,OAAO,CAAC;QACdC,IAAI;QACJC,MAAM,IAAMH,QAAQC,OAAO,CAAC,CAAC;QAC7BG,MAAM,IAAMJ,QAAQC,OAAO,CAAC;QAC5BI,QAAQ;QACRC,YAAY;IACd;AAGF,2DAA2D;AAC3D,OAAOC,OAAOC,QAAQ;AACtBD,OAAOC,QAAQ,GAAG;IAChBC,MAAM;IACNC,QAAQ7G,KAAKG,EAAE;IACfoF,SAASvF,KAAKG,EAAE;IAChB2G,QAAQ9G,KAAKG,EAAE;IACf4G,UAAU/G,KAAKG,EAAE,CAAC,IAAM;AAC1B;AAEA,sBAAsB;AACtB8F,OAAOe,cAAc,GAAGhH,KAAKG,EAAE,GAAG8G,kBAAkB,CAAC,IAAO,CAAA;QAC1DC,SAASlH,KAAKG,EAAE;QAChBgH,WAAWnH,KAAKG,EAAE;QAClBiH,YAAYpH,KAAKG,EAAE;IACrB,CAAA;AAEA,4BAA4B;AAC5B8F,OAAOoB,oBAAoB,GAAGrH,KAAKG,EAAE,GAAG8G,kBAAkB,CAAC,IAAO,CAAA;QAChEC,SAASlH,KAAKG,EAAE;QAChBgH,WAAWnH,KAAKG,EAAE;QAClBiH,YAAYpH,KAAKG,EAAE;IACrB,CAAA"}