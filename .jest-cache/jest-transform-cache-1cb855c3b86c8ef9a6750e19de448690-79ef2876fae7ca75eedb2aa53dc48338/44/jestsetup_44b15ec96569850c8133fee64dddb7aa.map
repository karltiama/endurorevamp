{"version":3,"sources":["C:\\Users\\tiama\\Desktop\\Coding\\endurorevamp\\jest.setup.js"],"sourcesContent":["// Global test setup\r\nimport '@testing-library/jest-dom'\r\n\r\n// Create global router mocks that can be overridden in tests\r\nconst mockRouterFunctions = {\r\n  push: jest.fn(),\r\n  replace: jest.fn(),\r\n  back: jest.fn(),\r\n  forward: jest.fn(),\r\n  refresh: jest.fn(),\r\n  prefetch: jest.fn(),\r\n}\r\n\r\n// Mock Next.js server-side functions globally\r\njest.mock('next/navigation', () => ({\r\n  useRouter: jest.fn(() => mockRouterFunctions),\r\n  useSearchParams: () => new URLSearchParams(),\r\n  usePathname: () => '/',\r\n  redirect: jest.fn(),\r\n  __mockRouterFunctions: mockRouterFunctions, // Export for test access\r\n}))\r\n\r\n// Mock Next.js cookies and headers (server-side)\r\njest.mock('next/headers', () => ({\r\n  cookies: () => ({\r\n    get: jest.fn(),\r\n    set: jest.fn(),\r\n    delete: jest.fn(),\r\n  }),\r\n  headers: () => ({\r\n    get: jest.fn(),\r\n  }),\r\n}))\r\n\r\n// Mock Supabase clients globally to prevent server-side call issues\r\njest.mock('@/lib/supabase/client', () => ({\r\n  createClient: jest.fn(() => ({\r\n    auth: {\r\n      getUser: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\r\n      onAuthStateChange: jest.fn(() => ({ data: { subscription: { unsubscribe: jest.fn() } } })),\r\n      signOut: jest.fn().mockResolvedValue({ error: null }),\r\n    },\r\n    from: jest.fn(() => ({\r\n      select: jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          single: jest.fn().mockResolvedValue({ data: null, error: null }),\r\n          limit: jest.fn(() => ({\r\n            order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n          })),\r\n        })),\r\n        order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n      })),\r\n      insert: jest.fn(() => ({\r\n        select: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n      })),\r\n      update: jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          select: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n        })),\r\n      })),\r\n      upsert: jest.fn(() => ({\r\n        select: jest.fn(() => ({\r\n          single: jest.fn().mockResolvedValue({ data: {}, error: null }),\r\n        })),\r\n      })),\r\n    })),\r\n  })),\r\n}))\r\n\r\njest.mock('@/lib/supabase/server', () => ({\r\n  createClient: jest.fn(() => ({\r\n    auth: {\r\n      getUser: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\r\n    },\r\n    from: jest.fn(() => ({\r\n      select: jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          single: jest.fn().mockResolvedValue({ data: null, error: null }),\r\n          limit: jest.fn(() => ({\r\n            order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n          })),\r\n        })),\r\n        order: jest.fn().mockResolvedValue({ data: [], error: null }),\r\n      })),\r\n    })),\r\n  })),\r\n}))\r\n\r\n// Mock common application hooks globally\r\njest.mock('@/hooks/useGoals', () => ({\r\n  useUserGoals: jest.fn(() => ({ data: { goals: [], onboarding: null }, isLoading: false, error: null, refetch: jest.fn() })),\r\n  useUpdateGoal: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n  useCreateGoal: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n  useDeleteGoal: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n  useGoalTypes: jest.fn(() => ({ data: [], isLoading: false, error: null })),\r\n  useCreateMultipleGoals: jest.fn(() => ({ mutate: jest.fn(), isLoading: false, error: null })),\r\n}))\r\n\r\njest.mock('@/hooks/use-user-activities', () => ({\r\n  useUserActivities: jest.fn(() => ({ data: [], isLoading: false, error: null, refetch: jest.fn() })),\r\n}))\r\n\r\njest.mock('@/hooks/use-strava-sync', () => ({\r\n  useStravaSync: jest.fn(() => ({\r\n    syncData: jest.fn(),\r\n    isLoading: false,\r\n    error: null,\r\n    lastSyncTime: null,\r\n  })),\r\n}))\r\n\r\njest.mock('@/hooks/useUnitPreferences', () => {\r\n  const mockSetDistanceUnit = jest.fn()\r\n  const mockToggleUnits = jest.fn()\r\n  const mockUpdatePreferences = jest.fn()\r\n  \r\n  return {\r\n    useUnitPreferences: jest.fn(() => ({\r\n      preferences: { distance: 'km', pace: 'min/km' },\r\n      updatePreferences: mockUpdatePreferences,\r\n      setDistanceUnit: mockSetDistanceUnit,\r\n      toggleUnits: mockToggleUnits,\r\n      isLoading: false\r\n    })),\r\n    __mocks: {\r\n      setDistanceUnit: mockSetDistanceUnit,\r\n      toggleUnits: mockToggleUnits,\r\n      updatePreferences: mockUpdatePreferences,\r\n    }\r\n  }\r\n})\r\n\r\njest.mock('@/providers/AuthProvider', () => ({\r\n  useAuth: jest.fn(() => ({\r\n    user: null,\r\n    isLoading: false,\r\n    isAuthenticated: false,\r\n    signOut: jest.fn(),\r\n    refreshUser: jest.fn()\r\n  })),\r\n}))\r\n\r\n// Mock environment variables\r\nprocess.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co'\r\nprocess.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key'\r\nprocess.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key'\r\n\r\n// REMOVED: Heavy console mocking that was running before every test\r\n// REMOVED: beforeEach/afterEach hooks that were adding overhead\r\n\r\n// Mock fetch globally\r\nglobal.fetch = jest.fn(() =>\r\n  Promise.resolve({\r\n    ok: true,\r\n    json: () => Promise.resolve({}),\r\n    text: () => Promise.resolve(''),\r\n    status: 200,\r\n    statusText: 'OK',\r\n  })\r\n)\r\n\r\n// Mock window.location in a safe way that works with JSDOM\r\ndelete window.location\r\nwindow.location = {\r\n  href: '',\r\n  assign: jest.fn(),\r\n  replace: jest.fn(),\r\n  reload: jest.fn(),\r\n  toString: jest.fn(() => 'http://localhost/'),\r\n}\r\n\r\n// Mock ResizeObserver\r\nglobal.ResizeObserver = jest.fn().mockImplementation(() => ({\r\n  observe: jest.fn(),\r\n  unobserve: jest.fn(),\r\n  disconnect: jest.fn(),\r\n}))\r\n\r\n// Mock IntersectionObserver\r\nglobal.IntersectionObserver = jest.fn().mockImplementation(() => ({\r\n  observe: jest.fn(),\r\n  unobserve: jest.fn(),\r\n  disconnect: jest.fn(),\r\n})) "],"names":["jest","mock","useRouter","fn","mockRouterFunctions","useSearchParams","URLSearchParams","usePathname","redirect","__mockRouterFunctions","cookies","get","set","delete","headers","createClient","auth","getUser","mockResolvedValue","data","user","error","onAuthStateChange","subscription","unsubscribe","signOut","from","select","eq","single","limit","order","insert","update","upsert","useUserGoals","goals","onboarding","isLoading","refetch","useUpdateGoal","mutate","useCreateGoal","useDeleteGoal","useGoalTypes","useCreateMultipleGoals","useUserActivities","useStravaSync","syncData","lastSyncTime","mockSetDistanceUnit","mockToggleUnits","mockUpdatePreferences","useUnitPreferences","preferences","distance","pace","updatePreferences","setDistanceUnit","toggleUnits","__mocks","useAuth","isAuthenticated","refreshUser","push","replace","back","forward","refresh","prefetch","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_SERVICE_ROLE_KEY","global","fetch","Promise","resolve","ok","json","text","status","statusText","window","location","href","assign","reload","toString","ResizeObserver","mockImplementation","observe","unobserve","disconnect","IntersectionObserver"],"mappings":"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"}